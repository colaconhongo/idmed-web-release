import{J as Sr,l as cg,r as V,c as Ue,bH as dg,aQ as pg,aE as vg,h as br,g as hg,V as Qe,cw as Go,b8 as Wn,i as _e,o as Si,z as gg,cd as bi,K as ue,L as Ae,M as O,O as se,S as mg,f as E,N as _g,P as nr,a5 as be,a7 as A,R as Di,cx as Qo,a6 as Me,U as tr,bP as wg,W as yg,be as da,cy as ia,bO as Ye,a1 as Le,a8 as ua,bI as Dg,cc as bg,b_ as Tt,b4 as pa,cz as Pr,Y as Ko,ce as Zo,w as Pg,a_ as Tn,a4 as tn,cA as xr,a9 as Jo,cB as aa,cf as Pi,$ as la,cC as xg,cD as Sg,cE as Rg,cF as Ag,cG as Tg,cH as ea,bg as Eg,bZ as Cg,cI as kg,cJ as Ig,cK as Lg,B as No,H as na,C as Yo,I as Mg,bG as Og,c2 as Bo,cL as Wo,cM as $o,ba as Fg,F as Vg,cN as Ug}from"./index.28c7e456.js";import{Q as oa,a as sa}from"./QPopupProxy.bc9f6d75.js";import{Q as An}from"./QSelect.caa108f8.js";import{Q as Xo}from"./ListHeader.c33af243.js";import{a as fa,c as er,b as Vn,Q as jo}from"./QTable.f91943bc.js";import{c as qg,a as ta,b as zo,Q as ra}from"./QMenu.9a83401e.js";import{C as ca}from"./ClosePopup.20eb2e56.js";import{Q as Ng}from"./QTooltip.f3ef7ac8.js";import{_ as Yg}from"./plugin-vue_export-helper.21dcd24c.js";import{u as es}from"./drugMethods.baae673f.js";function Bg(){function C(D){return D.code==="FIM"}function de(D){return D.episodeType===null?!1:D.episodeType.code==="INICIO"}function l(D){return D.episodeType===null||D.episodeType===void 0?!1:D.episodeType.code==="FIM"}function S(D){return D.startStopReason===null||D.startStopReason===void 0?!1:D.startStopReason.code==="VOLTOU_REFERENCIA"}function P(D){return D.startStopReason===null||D.startStopReason===void 0?!1:D.startStopReason.code==="REFERIDO_DC"}function $(D){return D.startStopReason===null||D.startStopReason===void 0?!1:D.startStopReason.code==="REFERIDO_PARA"}function U(D){return D!==null?P(D)||x(D)||$(D):!1}function x(D){return D.startStopReason===null?!1:D.startStopReason.code==="TRANSFERIDO_PARA"}function ne(D){return D.patientVisitDetails.length>0}function Se(D){let I="";return D.patientVisitDetails.forEach(j=>{(I===null||I===""||j.patientVisit.visitDate>I.patientVisit.visitDate)&&(I=j)}),I}async function G(D){D.syncStatus==="R"&&await D.apiSave(D),D.syncStatus==="U"&&await D.apiUpdate(D)}function ve(D){const I=D[0];return["REFERIDO_PARA","REFERIDO_SECTOR_CLINICO","REFERIDO_DC"].includes(I.startStopReason.code)}function N(){return"episode"}return{closed:C,isStartEpisode:de,isCloseEpisode:l,isBackReferenceEpisode:S,isDCReferenceEpisode:P,isReferenceEpisode:$,isReferenceOrTransferenceEpisode:U,isTranferenceEpisode:x,hasVisits:ne,lastVisit:Se,syncEpisode:G,getClassName:N,checkIsReferedToRemove:ve}}const{hasVisits:Wg}=Bg();function $g(){function C(N){return N.prefered}function de(N){let D="";return N.patientVisitDetails.forEach(I=>{(D===""||D===null||I.pack.pickupDate>D.pack.pickupDate)&&(D=I)}),D.pack}function l(N){let D="";return N.episodes.forEach(I=>{I.patientVisitDetails!==null&&I.patientVisitDetails!==void 0&&I.patientVisitDetails.forEach(j=>{D===null||D===""?(D=j,D.pack!==null&&j.pack!==null&&(j.pack.pickupDate>D.pack.pickupDate,D=j)):D=j})}),D}function S(N){let D="";return N.episodes.forEach(I=>{(D===null||D===""||I.episodeDate>D.episodeDate)&&(D=I)}),D}function P(N,D){return N.service===""||N.service===null?!1:N.service.clinicalServiceAttributes.some(j=>j.clinicalServiceAttributeType.code===D)}function $(N){return P(N,"THERAPEUTICAL_REGIMEN")}function U(N){return P(N,"THERAPEUTICAL_LINE")}function x(N){return P(N,"PATIENT_TYPE")}function ne(N){return P(N,"PRESCRIPTION_CHANGE_MOTIVE")}function Se(N){return N.episodes.length>0}function G(N){if(!Se(N))return!0;let D=!0;return Object.keys(N.episodes).forEach(function(I){const j=N.episodes[I];D&&Wg(j)&&(D=!1)}.bind(N)),D}function ve(){return"patientServiceIdentifier"}return{isPrefered:C,lastStartEpisodeWithPrescription:de,lastVisitPrescription:l,lastEpisodeIdentifier:S,checkClinicalServiceAttr:P,hasTherapeuticalRegimen:$,hasTherapeuticalLine:U,hasPatientType:x,hasPrescriptionChangeMotive:ne,hasEpisodes:Se,canBeEdited:G,getClassName:ve}}function ns(){function C(P,$){P.leftDuration===0?P.leftDuration=Number((Number(P.duration.weeks)-Number($))/4):P.leftDuration=Number((Number(P.leftDuration*4)-Number($))/4)}function de(P){const $=P.duration!==null&&P.duration!==void 0?Number(P.duration.weeks):0;let U=0;return P.patientVisitDetails.forEach(x=>{(x.pack!==null&&x.pack!==void 0||x.pack_id!==null)&&(x.pack=Sr.getPackWithsByID(x.pack_id),x.pack!==null&&(U=Number(U+x.pack.weeksSupply)))}),Number(($-U)/4)}function l(P){const $=Number(P.duration.weeks);let U=0;return P.patientVisitDetails.forEach(x=>{x.pack!==null&&x.pack!==void 0&&(U=Number(U+x.pack.weeksSupply))}),Number($-U)}function S(P){let $="";return P.patientVisitDetails.forEach(U=>{($===null||$===""||U.pack.pickupDate>$.pack.pickupDate)&&($=U)}),$.pack}return{calculateLeftDuration:C,remainigDuration:de,remainigDurationInWeeks:l,lastPackOnPrescription:S}}function Rr(C,de=new WeakMap){if(Object(C)!==C)return C;if(de.has(C))return de.get(C);const l=C instanceof Date?new Date(C):C instanceof RegExp?new RegExp(C.source,C.flags):C instanceof Set?new Set:C instanceof Map?new Map:typeof C.constructor!="function"?Object.create(null):C.prototype!==void 0&&typeof C.prototype.constructor=="function"?C:new C.constructor;if(typeof C.constructor=="function"&&typeof C.valueOf=="function"){const S=C.valueOf();if(Object(S)!==S){const P=new C.constructor(S);return de.set(C,P),P}}return de.set(C,l),C instanceof Set?C.forEach(S=>{l.add(Rr(S,de))}):C instanceof Map&&C.forEach((S,P)=>{l.set(P,Rr(S,de))}),Object.assign(l,...Object.keys(C).map(S=>({[S]:Rr(C[S],de)})))}var zg=cg({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(C,{slots:de,emit:l}){const{proxy:S}=hg(),{$q:P}=S,$=V(null),U=V(""),x=V("");let ne=!1;const Se=Ue(()=>dg({initialValue:U.value,validate:C.validate,set:G,cancel:ve,updatePosition:N},"value",()=>x.value,Pe=>{x.value=Pe}));function G(){C.validate(x.value)!==!1&&(D()===!0&&(l("save",x.value,U.value),l("update:modelValue",x.value)),I())}function ve(){D()===!0&&l("cancel",x.value,U.value),I()}function N(){pg(()=>{$.value.updatePosition()})}function D(){return vg(x.value,U.value)===!1}function I(){ne=!0,$.value.hide()}function j(){ne=!1,U.value=Rr(C.modelValue),x.value=Rr(C.modelValue),l("beforeShow")}function fe(){l("show")}function K(){ne===!1&&D()===!0&&(C.autoSave===!0&&C.validate(x.value)===!0?(l("save",x.value,U.value),l("update:modelValue",x.value)):l("cancel",x.value,U.value)),l("beforeHide")}function pe(){l("hide")}function ae(){const Pe=de.default!==void 0?[].concat(de.default(Se.value)):[];return C.title&&Pe.unshift(br("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},C.title)),C.buttons===!0&&Pe.push(br("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[br(Qe,{flat:!0,color:C.color,label:C.labelCancel||P.lang.label.cancel,onClick:ve}),br(Qe,{flat:!0,color:C.color,label:C.labelSet||P.lang.label.set,onClick:G})])),Pe}return Object.assign(S,{set:G,cancel:ve,show(Pe){$.value!==null&&$.value.show(Pe)},hide(Pe){$.value!==null&&$.value.hide(Pe)},updatePosition:N}),()=>{if(C.disable!==!0)return br(qg,{ref:$,class:"q-popup-edit",cover:C.cover,onBeforeShow:j,onShow:fe,onBeforeHide:K,onHide:pe,onEscapeKey:ve},ae)}}});const Hg={class:"q-pt-md q-mb-sm bg-green-2"},Gg={class:"row items-center q-mb-sm q-pa-sm"},Qg={class:"text-subtitle2 q-ml-sm"},Kg={class:"q-px-md"},Zg={class:"row"},ts={__name:"AddEditPrescribedDrug",setup(C){const{idadeCalculator:de,getDDMMYYYFromJSDate:l,getYYYYMMDDFromJSDate:S}=da(),P=V(new Go({id:Wn()})),$=V(!1),U=V(["0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1","1.5","2","2.5","3","3.5","4","4.5"]),x=V(["1","2","3","4"]),ne=V(["Dia","Semana","M\xEAs","Ano"]),Se=V([]),G=V(null),ve=V(null),N=V(null),D=V(null);_e("curPatientVisitDetail");const I=_e("hasTherapeuticalRegimen"),j=_e("curPrescriptionDetail"),fe=_e("curIdentifier"),K=_e("addPrescribedDrug");_e("curPack");const pe=_e("showAddEditDrug"),ae=_e("submittingPrescribedDrug");Si(()=>{$.value=!0});const Pe=()=>{ae.value=!0,D.value.validate(),G.value.validate(),ve.value.validate(),N.value.validate(),!D.value.hasError&&!G.value.hasError&&!ve.value.hasError&&!N.value.hasError?K(P.value):ae.value=!1},Be=Ue(()=>{const ke=gg.getById(fe.patient_id);return de(l(ke.dateOfBirth))}),qe=Ue(()=>{let ke=[];return $.value?ke=bi.getActiveDrugsByRegimen(j.value.therapeuticRegimen.id):(ke=rn.value,ke=ke.filter(re=>re.clinicalService!==null&&re.clinicalService.code===(fe.service!==void 0?fe.service.code:fe.value.service.code)&&re.active===!0)),ke}),Oe=()=>{P.value.drug!==null&&(P.value.amtPerTime=P.value.drug.defaultTreatment,P.value.timesPerDay=P.value.drug.defaultTimes,P.value.form=P.value.drug.defaultPeriodTreatment)},rn=Ue(()=>bi.getAllDrugs()),We=(ke,re,M)=>{const y=qe.value;ke===""?re(()=>{Se.value=y.map(m=>(String(m.name).includes(String(m.form.description).substring(0,4))||(m.name=String(m.name).concat(" - (").concat(m.packSize).concat(" ").concat(String(m.form.description).substring(0,4)).concat(")")),m))}):y.length===0?re(()=>{Se.value=[]}):re(()=>{Se.value=y.map(m=>m).filter(m=>m&&m.name.toLowerCase().indexOf(ke.toLowerCase())!==-1)})};return(ke,re)=>(ue(),Ae(yg,{style:{width:"800px","max-width":"90vw"}},{default:O(()=>[se("form",{onSubmit:mg(Pe,["prevent"])},[E(_g,{class:"q-pa-none"},{default:O(()=>[se("div",Hg,[se("div",Gg,[E(nr,{name:"medication",size:"md",color:"green-10"}),se("span",Qg,"Adi\xE7\xE3o de Medicamentos para "+be(A(fe).service.description),1)]),E(Di,{color:"grey-13",size:"1px",class:"q-mb-sm"})]),se("div",Kg,[A(I)?(ue(),Ae(Qo,{key:0,modelValue:$.value,"onUpdate:modelValue":re[0]||(re[0]=M=>$.value=M),label:"Visualizar apenas os medicamentos do regime selecionado"},null,8,["modelValue"])):Me("",!0),E(An,{class:"col q-my-md",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:We,ref_key:"drugRef",ref:D,rules:[M=>!!M||"Por favor indicar o medicamento."],modelValue:P.value.drug,"onUpdate:modelValue":[re[1]||(re[1]=M=>P.value.drug=M),Oe],options:Se.value,"option-value":"id","option-label":"name",label:"Medicamento"},null,8,["rules","modelValue","options"]),se("div",Zg,[E(An,{class:"col",dense:"",outlined:"",ref_key:"amtPerTimeRef",ref:G,rules:[M=>!!M||"Por favor indicar a quantidade a tomar de cada vez."],modelValue:P.value.amtPerTime,"onUpdate:modelValue":re[2]||(re[2]=M=>P.value.amtPerTime=M),options:Be.value<=14?U.value:x.value,label:P.value.drug!==null&&P.value.drug!==void 0?P.value.drug.form.howToUse:"Tomar"},null,8,["rules","modelValue","options","label"]),P.value.drug?(ue(),Ae(tr,{key:0,outlined:"",type:"text",disable:!0,modelValue:P.value.drug.form.unit,"onUpdate:modelValue":re[3]||(re[3]=M=>P.value.drug.form.unit=M),label:"Forma Farmac\xEAutica",dense:"",class:"col q-ml-md"},null,8,["modelValue"])):Me("",!0),E(tr,{outlined:"",type:"text",modelValue:P.value.timesPerDay,"onUpdate:modelValue":re[4]||(re[4]=M=>P.value.timesPerDay=M),label:"N\xFAmero de vezes a tomar",ref_key:"formRef",ref:ve,rules:[M=>!!M||"Por favor indicar o numero de vezes a tomar"],suffix:"Vez(es)",dense:"",class:"col q-ml-md"},null,8,["modelValue","rules"]),E(An,{prefix:"Por ",class:"col q-ml-md",dense:"",outlined:"",ref_key:"timesRef",ref:N,rules:[M=>!!M||"Por favor indicar a periodicidade da toma"],modelValue:P.value.form,"onUpdate:modelValue":re[5]||(re[5]=M=>P.value.form=M),options:ne.value,label:"Per\xEDodo"},null,8,["rules","modelValue","options"])])])]),_:1}),E(wg,{align:"right",class:"q-my-md q-mr-sm"},{default:O(()=>[E(Qe,{label:"Cancelar",color:"red",onClick:re[6]||(re[6]=M=>pe.value=!1)}),E(Qe,{type:"submit",loading:A(ae),label:"Adicionar",color:"primary"},null,8,["loading"])]),_:1})],32)]),_:1}))}};function Jg(){function C(x){return x.code==="DN"}function de(x){return x.code==="DS"}function l(x){return x.code==="DB"}function S(x){return x.code==="DM"||x.code==="FRM"}function P(x){return x.code==="DT"}function $(x){return x.code==="DA"}function U(x){if(C(x))return 1;if(S(x))return 4;if(l(x))return 8;if(P(x))return 12;if(de(x))return 24;if($(x))return 52}return{isDS:de,isDB:l,isDM:S,isDT:P,isDA:$,getRelatedWeeks:U}}const Xg={class:"text-bold text-subtitle1 vertical-middle q-pl-md"},jg={class:"row items-center justify-end"},em={class:"row items-center justify-end"},nm={__name:"PrescriptionDrugsListHeader",props:["addVisible","mainContainer","bgColor"],setup(C){const de=C,{extractHyphenDateFromDMYConvertYMD:l,getDateFromHyphenDDMMYYYY:S,getDateFormatDDMMYYYYFromYYYYMMDD:P,getJSDateFromDDMMYYY:$}=da(),{alertSucess:U,alertError:x,alertInfo:ne}=pa(),{getRelatedWeeks:Se}=Jg(),G=V(""),ve=V(!1);V("");const N=V(""),D=V(""),I=V(),j=_e("curPrescriptionDetail"),fe=_e("curPatientVisit"),K=_e("curPrescription"),pe=_e("curPack"),ae=_e("isNewPrescription"),Pe=_e("durations"),Be=_e("showAddEditDrug"),qe=_e("validateDispense"),Oe=_e("lastPack");Si(()=>{y(),rn()});const rn=()=>{de.mainContainer?G.value="list-header":G.value=""},We=()=>{ve.value=!ve.value,$emit("expandLess",ve)},ke=()=>{Tt.isValid(l(D.value))?Tt.isValid(l(N.value))?I.value===""?x("Por favor indicar a dura\xE7\xE3o da medica\xE7\xE3o a dispensar."):l(D.value)>Ye().format("YYYY-MM-DD")?x("A data de levantamento indicada \xE9 maior que a data da corrente"):l(D.value)>l(N.value)?x("A data do levantamento \xE9 maior que a data do pr\xF3ximo levantamento"):Be.value=!0:x("A data do pr\xF3ximo levantamento \xE9 inv\xE1lida"):x("A data de levantamento \xE9 inv\xE1lida")},re=(le,Q)=>{if(Tt.isValid(l(le))){const J=S(le);let vt=parseInt(Q/4*2);Q<=1&&(vt=0);const tt=parseInt(Q*7+vt);N.value=m(Tt.addToDate(J,{days:tt})),pe.value.packDate=l(le),pe.value.pickupDate=l(le),pe.value.nextPickUpDate=l(N.value),pe.value.weeksSupply=Q}},M=()=>{pe.value.nextPickUpDate=l(N.value)},y=()=>{ae.value?(D.value=m(K.value.prescriptionDate),j.value.dispenseType!==null&&j.value.dispenseType!==void 0?I.value=ia.getDurationByWeeks(Se(j.value.dispenseType)):I.value=K.value.duration):(D.value=q(Ye()),Oe.value.nextPickUpDate!==null&&Oe.value.nextPickUpDate!==void 0?(pe.value.pickupDate=q(Ye()),pe.value.weeksSupply=Oe.value.weeksSupply,I.value=ia.getDurationByWeeks(pe.value.weeksSupply)):(pe.value.pickupDate=q(Ye()),pe.value.weeksSupply=K.value.duration.weeks,I.value=K.value.duration),D.value=m(pe.value.pickupDate)),re(D.value,I.value.weeks)},m=le=>Ye(le).local().format("DD-MM-YYYY"),q=le=>Ye(le).local().format("YYYY-MM-DD");return Le("drugsDuration",I),(le,Q)=>(ue(),Ae(Xo,{dense:"","inline-actions":"",class:bg([[C.bgColor,G.value],"text-white q-pa-none"])},{action:O(()=>[A(fe).createPackLater?Me("",!0):(ue(),Ae(tr,{key:0,dense:"",outlined:"",disable:A(qe),"bg-color":"white",style:{margin:"2px",width:"200px"},modelValue:D.value,"onUpdate:modelValue":[Q[2]||(Q[2]=J=>D.value=J),Q[3]||(Q[3]=J=>re(D.value,I.value.weeks))],ref:"pickupDateRef",label:"Data de Levantamento"},{append:O(()=>[E(nr,{name:"event",class:"cursor-pointer"},{default:O(()=>[E(oa,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:O(()=>[E(sa,{modelValue:D.value,"onUpdate:modelValue":[Q[0]||(Q[0]=J=>D.value=J),Q[1]||(Q[1]=J=>re(D.value,I.value.weeks))],mask:"DD-MM-YYYY",disable:A(qe)},{default:O(()=>[se("div",jg,[ua(E(Qe,{label:"Close",color:"primary",flat:""},null,512),[[ca]])])]),_:1},8,["modelValue","disable"])]),_:1},512)]),_:1})]),_:1},8,["disable","modelValue"])),A(fe).createPackLater?Me("",!0):(ue(),Ae(An,{key:1,dense:"",disable:A(qe),style:{width:"200px"},class:"q-mx-sm","bg-color":"white","onUpdate:modelValue":[Q[4]||(Q[4]=J=>re(D.value,J.weeks)),Q[5]||(Q[5]=J=>I.value=J)],outlined:"",modelValue:I.value,options:A(Pe),"option-value":"id","option-label":"description",label:"Dispensa para"},null,8,["disable","modelValue","options"])),A(fe).createPackLater?Me("",!0):(ue(),Ae(tr,{key:2,outlined:"",dense:"",disable:A(qe),modelValue:N.value,"onUpdate:modelValue":[Q[8]||(Q[8]=J=>N.value=J),Q[9]||(Q[9]=J=>M())],label:"Proximo Levantamento","bg-color":"white",style:{margin:"2px",width:"200px"},ref:"nextPickupDateRef"},{append:O(()=>[E(nr,{name:"event",class:"cursor-pointer"},{default:O(()=>[E(oa,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:O(()=>[E(sa,{modelValue:N.value,"onUpdate:modelValue":[Q[6]||(Q[6]=J=>N.value=J),Q[7]||(Q[7]=J=>M())],mask:"DD-MM-YYYY"},{default:O(()=>[se("div",em,[ua(E(Qe,{label:"Close",color:"primary",flat:""},null,512),[[ca]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["disable","modelValue"])),E(Qe,{dense:"",flat:"",round:"",color:"white",icon:ve.value?"expand_less":"expand_more",class:"float-right",onClick:We},null,8,["icon"]),C.addVisible?(ue(),Ae(Qe,{key:3,dense:"",flat:"",round:"",disable:A(qe),color:"white",icon:"add",class:"float-right q-mx-sm",onClick:ke},null,8,["disable"])):Me("",!0)]),default:O(()=>[se("span",Xg,[Dg(le.$slots,"default",{},void 0,!0)])]),_:3},8,["class"]))}};var tm=Yg(nm,[["__scopeId","data-v-07df5cd5"]]);function xi(){function C(S){return`${S.amtPerTime} ${S.form} ${S.timesPerDay}`}function de(S,P){if(P===null||P==="")return 0;let $=parseInt(String(P/4*2));P<=1&&($=0);const U=parseInt(String(P*7+$));let x=0;return S.form.toLowerCase()==="dia"?x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*U/S.drug.packSize)):S.form.toLowerCase()==="semana"?x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize)):S.form.toLowerCase()==="mes"?P<4?x=-1:x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize)):S.form.toLowerCase()==="ano"&&(P<52?x=-1:x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize))),x}function l(S,P){if(P===null||P==="")return 0;let $=parseInt(String(P/4*2));P<=1&&($=0);const U=parseInt(String(P*7+$));let x=0,ne=0;return S.form.toLowerCase()==="dia"?(x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*U/S.drug.packSize)),ne=x*S.drug.packSize-S.amtPerTime*S.timesPerDay*U):S.form.toLowerCase()==="semana"?(x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize)),ne=x*S.drug.packSize-S.amtPerTime*S.timesPerDay*P):S.form.toLowerCase()==="mes"?P<4?x=-1:(x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize)),ne=x*S.drug.packSize-S.amtPerTime*S.timesPerDay*P):S.form.toLowerCase()==="ano"&&(P<52?x=-1:(x=Math.ceil(Number(S.amtPerTime*S.timesPerDay*P/S.drug.packSize)),ne=S.drug.packSize*x-S.amtPerTime*S.timesPerDay*P)),Number.isInteger(ne)?ne:Number(ne).toFixed(1)}return{gettakeInstructions:C,getQtyPrescribed:de,getQtyRemain:l}}var Ho={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(C,de){(function(){var l,S="4.17.21",P=200,$="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",U="Expected a function",x="Invalid `variable` option passed into `_.template`",ne="__lodash_hash_undefined__",Se=500,G="__lodash_placeholder__",ve=1,N=2,D=4,I=1,j=2,fe=1,K=2,pe=4,ae=8,Pe=16,Be=32,qe=64,Oe=128,rn=256,We=512,ke=30,re="...",M=800,y=16,m=1,q=2,le=3,Q=1/0,J=9007199254740991,vt=17976931348623157e292,tt=0/0,ce=4294967295,ht=ce-1,Et=ce>>>1,Ct=[["ary",Oe],["bind",fe],["bindKey",K],["curry",ae],["curryRight",Pe],["flip",We],["partial",Be],["partialRight",qe],["rearg",rn]],En="[object Arguments]",$n="[object Array]",kt="[object AsyncFunction]",zn="[object Boolean]",Un="[object Date]",It="[object DOMException]",Lt="[object Error]",Te="[object Function]",je="[object GeneratorFunction]",Ne="[object Map]",Cn="[object Number]",Mt="[object Null]",kn="[object Object]",Ot="[object Promise]",Ar="[object Proxy]",Hn="[object RegExp]",dn="[object Set]",gt="[object String]",Ft="[object Symbol]",Ri="[object Undefined]",mt="[object WeakMap]",Ai="[object WeakSet]",rt="[object ArrayBuffer]",ge="[object DataView]",In="[object Float32Array]",it="[object Float64Array]",_t="[object Int8Array]",Ee="[object Int16Array]",Ke="[object Int32Array]",rr="[object Uint8Array]",ir="[object Uint8ClampedArray]",Vt="[object Uint16Array]",ur="[object Uint32Array]",Ti=/\b__p \+= '';/g,Ei=/\b(__p \+=) '' \+/g,Ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Tr=/&(?:amp|lt|gt|quot|#39);/g,Er=/[&<>"']/g,Cr=RegExp(Tr.source),kr=RegExp(Er.source),ki=/<%-([\s\S]+?)%>/g,Ii=/<%([\s\S]+?)%>/g,Ir=/<%=([\s\S]+?)%>/g,Li=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mi=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ar=/[\\^$.*+?()[\]{}|]/g,Oi=RegExp(ar.source),qt=/^\s+/,qn=/\s/,Lr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Fi=/\{\n\/\* \[wrapped with (.+)\] \*/,Vi=/,? & /,Ui=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qi=/[()=,{}\[\]\/\s]/,Ni=/\\(\\)?/g,Yi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Mr=/\w*$/,Bi=/^[-+]0x[0-9a-f]+$/i,Wi=/^0b[01]+$/i,d=/^\[object .+?Constructor\]$/,h=/^0o[0-7]+$/i,p=/^(?:0|[1-9]\d*)$/,F=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,R=/($^)/,Ze=/['\n\r\u2028\u2029\\]/g,$e="\\ud800-\\udfff",rs="\\u0300-\\u036f",is="\\ufe20-\\ufe2f",us="\\u20d0-\\u20ff",va=rs+is+us,ha="\\u2700-\\u27bf",ga="a-z\\xdf-\\xf6\\xf8-\\xff",as="\\xac\\xb1\\xd7\\xf7",ls="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",os="\\u2000-\\u206f",ss=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ma="A-Z\\xc0-\\xd6\\xd8-\\xde",_a="\\ufe0e\\ufe0f",wa=as+ls+os+ss,$i="['\u2019]",fs="["+$e+"]",ya="["+wa+"]",Or="["+va+"]",Da="\\d+",cs="["+ha+"]",ba="["+ga+"]",Pa="[^"+$e+wa+Da+ha+ga+ma+"]",zi="\\ud83c[\\udffb-\\udfff]",ds="(?:"+Or+"|"+zi+")",xa="[^"+$e+"]",Hi="(?:\\ud83c[\\udde6-\\uddff]){2}",Gi="[\\ud800-\\udbff][\\udc00-\\udfff]",Nt="["+ma+"]",Sa="\\u200d",Ra="(?:"+ba+"|"+Pa+")",ps="(?:"+Nt+"|"+Pa+")",Aa="(?:"+$i+"(?:d|ll|m|re|s|t|ve))?",Ta="(?:"+$i+"(?:D|LL|M|RE|S|T|VE))?",Ea=ds+"?",Ca="["+_a+"]?",vs="(?:"+Sa+"(?:"+[xa,Hi,Gi].join("|")+")"+Ca+Ea+")*",hs="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",gs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ka=Ca+Ea+vs,ms="(?:"+[cs,Hi,Gi].join("|")+")"+ka,_s="(?:"+[xa+Or+"?",Or,Hi,Gi,fs].join("|")+")",ws=RegExp($i,"g"),ys=RegExp(Or,"g"),Qi=RegExp(zi+"(?="+zi+")|"+_s+ka,"g"),Ds=RegExp([Nt+"?"+ba+"+"+Aa+"(?="+[ya,Nt,"$"].join("|")+")",ps+"+"+Ta+"(?="+[ya,Nt+Ra,"$"].join("|")+")",Nt+"?"+Ra+"+"+Aa,Nt+"+"+Ta,gs,hs,Da,ms].join("|"),"g"),bs=RegExp("["+Sa+$e+va+_a+"]"),Ps=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ss=-1,xe={};xe[In]=xe[it]=xe[_t]=xe[Ee]=xe[Ke]=xe[rr]=xe[ir]=xe[Vt]=xe[ur]=!0,xe[En]=xe[$n]=xe[rt]=xe[zn]=xe[ge]=xe[Un]=xe[Lt]=xe[Te]=xe[Ne]=xe[Cn]=xe[kn]=xe[Hn]=xe[dn]=xe[gt]=xe[mt]=!1;var De={};De[En]=De[$n]=De[rt]=De[ge]=De[zn]=De[Un]=De[In]=De[it]=De[_t]=De[Ee]=De[Ke]=De[Ne]=De[Cn]=De[kn]=De[Hn]=De[dn]=De[gt]=De[Ft]=De[rr]=De[ir]=De[Vt]=De[ur]=!0,De[Lt]=De[Te]=De[mt]=!1;var Rs={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},As={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ts={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Es={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Cs=parseFloat,ks=parseInt,Ia=typeof Pr=="object"&&Pr&&Pr.Object===Object&&Pr,Is=typeof self=="object"&&self&&self.Object===Object&&self,Je=Ia||Is||Function("return this")(),Ki=de&&!de.nodeType&&de,wt=Ki&&!0&&C&&!C.nodeType&&C,La=wt&&wt.exports===Ki,Zi=La&&Ia.process,wn=function(){try{var f=wt&&wt.require&&wt.require("util").types;return f||Zi&&Zi.binding&&Zi.binding("util")}catch{}}(),Ma=wn&&wn.isArrayBuffer,Oa=wn&&wn.isDate,Fa=wn&&wn.isMap,Va=wn&&wn.isRegExp,Ua=wn&&wn.isSet,qa=wn&&wn.isTypedArray;function pn(f,g,v){switch(v.length){case 0:return f.call(g);case 1:return f.call(g,v[0]);case 2:return f.call(g,v[0],v[1]);case 3:return f.call(g,v[0],v[1],v[2])}return f.apply(g,v)}function Ls(f,g,v,k){for(var z=-1,he=f==null?0:f.length;++z<he;){var ze=f[z];g(k,ze,v(ze),f)}return k}function yn(f,g){for(var v=-1,k=f==null?0:f.length;++v<k&&g(f[v],v,f)!==!1;);return f}function Ms(f,g){for(var v=f==null?0:f.length;v--&&g(f[v],v,f)!==!1;);return f}function Na(f,g){for(var v=-1,k=f==null?0:f.length;++v<k;)if(!g(f[v],v,f))return!1;return!0}function ut(f,g){for(var v=-1,k=f==null?0:f.length,z=0,he=[];++v<k;){var ze=f[v];g(ze,v,f)&&(he[z++]=ze)}return he}function Fr(f,g){var v=f==null?0:f.length;return!!v&&Yt(f,g,0)>-1}function Ji(f,g,v){for(var k=-1,z=f==null?0:f.length;++k<z;)if(v(g,f[k]))return!0;return!1}function Re(f,g){for(var v=-1,k=f==null?0:f.length,z=Array(k);++v<k;)z[v]=g(f[v],v,f);return z}function at(f,g){for(var v=-1,k=g.length,z=f.length;++v<k;)f[z+v]=g[v];return f}function Xi(f,g,v,k){var z=-1,he=f==null?0:f.length;for(k&&he&&(v=f[++z]);++z<he;)v=g(v,f[z],z,f);return v}function Os(f,g,v,k){var z=f==null?0:f.length;for(k&&z&&(v=f[--z]);z--;)v=g(v,f[z],z,f);return v}function ji(f,g){for(var v=-1,k=f==null?0:f.length;++v<k;)if(g(f[v],v,f))return!0;return!1}var Fs=eu("length");function Vs(f){return f.split("")}function Us(f){return f.match(Ui)||[]}function Ya(f,g,v){var k;return v(f,function(z,he,ze){if(g(z,he,ze))return k=he,!1}),k}function Vr(f,g,v,k){for(var z=f.length,he=v+(k?1:-1);k?he--:++he<z;)if(g(f[he],he,f))return he;return-1}function Yt(f,g,v){return g===g?Zs(f,g,v):Vr(f,Ba,v)}function qs(f,g,v,k){for(var z=v-1,he=f.length;++z<he;)if(k(f[z],g))return z;return-1}function Ba(f){return f!==f}function Wa(f,g){var v=f==null?0:f.length;return v?tu(f,g)/v:tt}function eu(f){return function(g){return g==null?l:g[f]}}function nu(f){return function(g){return f==null?l:f[g]}}function $a(f,g,v,k,z){return z(f,function(he,ze,ye){v=k?(k=!1,he):g(v,he,ze,ye)}),v}function Ns(f,g){var v=f.length;for(f.sort(g);v--;)f[v]=f[v].value;return f}function tu(f,g){for(var v,k=-1,z=f.length;++k<z;){var he=g(f[k]);he!==l&&(v=v===l?he:v+he)}return v}function ru(f,g){for(var v=-1,k=Array(f);++v<f;)k[v]=g(v);return k}function Ys(f,g){return Re(g,function(v){return[v,f[v]]})}function za(f){return f&&f.slice(0,Ka(f)+1).replace(qt,"")}function vn(f){return function(g){return f(g)}}function iu(f,g){return Re(g,function(v){return f[v]})}function lr(f,g){return f.has(g)}function Ha(f,g){for(var v=-1,k=f.length;++v<k&&Yt(g,f[v],0)>-1;);return v}function Ga(f,g){for(var v=f.length;v--&&Yt(g,f[v],0)>-1;);return v}function Bs(f,g){for(var v=f.length,k=0;v--;)f[v]===g&&++k;return k}var Ws=nu(Rs),$s=nu(As);function zs(f){return"\\"+Es[f]}function Hs(f,g){return f==null?l:f[g]}function Bt(f){return bs.test(f)}function Gs(f){return Ps.test(f)}function Qs(f){for(var g,v=[];!(g=f.next()).done;)v.push(g.value);return v}function uu(f){var g=-1,v=Array(f.size);return f.forEach(function(k,z){v[++g]=[z,k]}),v}function Qa(f,g){return function(v){return f(g(v))}}function lt(f,g){for(var v=-1,k=f.length,z=0,he=[];++v<k;){var ze=f[v];(ze===g||ze===G)&&(f[v]=G,he[z++]=v)}return he}function Ur(f){var g=-1,v=Array(f.size);return f.forEach(function(k){v[++g]=k}),v}function Ks(f){var g=-1,v=Array(f.size);return f.forEach(function(k){v[++g]=[k,k]}),v}function Zs(f,g,v){for(var k=v-1,z=f.length;++k<z;)if(f[k]===g)return k;return-1}function Js(f,g,v){for(var k=v+1;k--;)if(f[k]===g)return k;return k}function Wt(f){return Bt(f)?js(f):Fs(f)}function Ln(f){return Bt(f)?ef(f):Vs(f)}function Ka(f){for(var g=f.length;g--&&qn.test(f.charAt(g)););return g}var Xs=nu(Ts);function js(f){for(var g=Qi.lastIndex=0;Qi.test(f);)++g;return g}function ef(f){return f.match(Qi)||[]}function nf(f){return f.match(Ds)||[]}var tf=function f(g){g=g==null?Je:$t.defaults(Je.Object(),g,$t.pick(Je,xs));var v=g.Array,k=g.Date,z=g.Error,he=g.Function,ze=g.Math,ye=g.Object,au=g.RegExp,rf=g.String,Dn=g.TypeError,qr=v.prototype,uf=he.prototype,zt=ye.prototype,Nr=g["__core-js_shared__"],Yr=uf.toString,we=zt.hasOwnProperty,af=0,Za=function(){var e=/[^.]+$/.exec(Nr&&Nr.keys&&Nr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Br=zt.toString,lf=Yr.call(ye),of=Je._,sf=au("^"+Yr.call(we).replace(ar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wr=La?g.Buffer:l,ot=g.Symbol,$r=g.Uint8Array,Ja=Wr?Wr.allocUnsafe:l,zr=Qa(ye.getPrototypeOf,ye),Xa=ye.create,ja=zt.propertyIsEnumerable,Hr=qr.splice,el=ot?ot.isConcatSpreadable:l,or=ot?ot.iterator:l,yt=ot?ot.toStringTag:l,Gr=function(){try{var e=St(ye,"defineProperty");return e({},"",{}),e}catch{}}(),ff=g.clearTimeout!==Je.clearTimeout&&g.clearTimeout,cf=k&&k.now!==Je.Date.now&&k.now,df=g.setTimeout!==Je.setTimeout&&g.setTimeout,Qr=ze.ceil,Kr=ze.floor,lu=ye.getOwnPropertySymbols,pf=Wr?Wr.isBuffer:l,nl=g.isFinite,vf=qr.join,hf=Qa(ye.keys,ye),He=ze.max,en=ze.min,gf=k.now,mf=g.parseInt,tl=ze.random,_f=qr.reverse,ou=St(g,"DataView"),sr=St(g,"Map"),su=St(g,"Promise"),Ht=St(g,"Set"),fr=St(g,"WeakMap"),cr=St(ye,"create"),Zr=fr&&new fr,Gt={},wf=Rt(ou),yf=Rt(sr),Df=Rt(su),bf=Rt(Ht),Pf=Rt(fr),Jr=ot?ot.prototype:l,dr=Jr?Jr.valueOf:l,rl=Jr?Jr.toString:l;function u(e){if(Ie(e)&&!H(e)&&!(e instanceof ie)){if(e instanceof bn)return e;if(we.call(e,"__wrapped__"))return io(e)}return new bn(e)}var Qt=function(){function e(){}return function(n){if(!Ce(n))return{};if(Xa)return Xa(n);e.prototype=n;var t=new e;return e.prototype=l,t}}();function Xr(){}function bn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=l}u.templateSettings={escape:ki,evaluate:Ii,interpolate:Ir,variable:"",imports:{_:u}},u.prototype=Xr.prototype,u.prototype.constructor=u,bn.prototype=Qt(Xr.prototype),bn.prototype.constructor=bn;function ie(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function xf(){var e=new ie(this.__wrapped__);return e.__actions__=on(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=on(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=on(this.__views__),e}function Sf(){if(this.__filtered__){var e=new ie(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Rf(){var e=this.__wrapped__.value(),n=this.__dir__,t=H(e),r=n<0,i=t?e.length:0,a=Uc(0,i,this.__views__),o=a.start,s=a.end,c=s-o,_=r?s:o-1,w=this.__iteratees__,b=w.length,T=0,L=en(c,this.__takeCount__);if(!t||!r&&i==c&&L==c)return Al(e,this.__actions__);var B=[];e:for(;c--&&T<L;){_+=n;for(var X=-1,W=e[_];++X<b;){var te=w[X],oe=te.iteratee,mn=te.type,ln=oe(W);if(mn==q)W=ln;else if(!ln){if(mn==m)continue e;break e}}B[T++]=W}return B}ie.prototype=Qt(Xr.prototype),ie.prototype.constructor=ie;function Dt(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function Af(){this.__data__=cr?cr(null):{},this.size=0}function Tf(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}function Ef(e){var n=this.__data__;if(cr){var t=n[e];return t===ne?l:t}return we.call(n,e)?n[e]:l}function Cf(e){var n=this.__data__;return cr?n[e]!==l:we.call(n,e)}function kf(e,n){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=cr&&n===l?ne:n,this}Dt.prototype.clear=Af,Dt.prototype.delete=Tf,Dt.prototype.get=Ef,Dt.prototype.has=Cf,Dt.prototype.set=kf;function Gn(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function If(){this.__data__=[],this.size=0}function Lf(e){var n=this.__data__,t=jr(n,e);if(t<0)return!1;var r=n.length-1;return t==r?n.pop():Hr.call(n,t,1),--this.size,!0}function Mf(e){var n=this.__data__,t=jr(n,e);return t<0?l:n[t][1]}function Of(e){return jr(this.__data__,e)>-1}function Ff(e,n){var t=this.__data__,r=jr(t,e);return r<0?(++this.size,t.push([e,n])):t[r][1]=n,this}Gn.prototype.clear=If,Gn.prototype.delete=Lf,Gn.prototype.get=Mf,Gn.prototype.has=Of,Gn.prototype.set=Ff;function Qn(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}function Vf(){this.size=0,this.__data__={hash:new Dt,map:new(sr||Gn),string:new Dt}}function Uf(e){var n=ci(this,e).delete(e);return this.size-=n?1:0,n}function qf(e){return ci(this,e).get(e)}function Nf(e){return ci(this,e).has(e)}function Yf(e,n){var t=ci(this,e),r=t.size;return t.set(e,n),this.size+=t.size==r?0:1,this}Qn.prototype.clear=Vf,Qn.prototype.delete=Uf,Qn.prototype.get=qf,Qn.prototype.has=Nf,Qn.prototype.set=Yf;function bt(e){var n=-1,t=e==null?0:e.length;for(this.__data__=new Qn;++n<t;)this.add(e[n])}function Bf(e){return this.__data__.set(e,ne),this}function Wf(e){return this.__data__.has(e)}bt.prototype.add=bt.prototype.push=Bf,bt.prototype.has=Wf;function Mn(e){var n=this.__data__=new Gn(e);this.size=n.size}function $f(){this.__data__=new Gn,this.size=0}function zf(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t}function Hf(e){return this.__data__.get(e)}function Gf(e){return this.__data__.has(e)}function Qf(e,n){var t=this.__data__;if(t instanceof Gn){var r=t.__data__;if(!sr||r.length<P-1)return r.push([e,n]),this.size=++t.size,this;t=this.__data__=new Qn(r)}return t.set(e,n),this.size=t.size,this}Mn.prototype.clear=$f,Mn.prototype.delete=zf,Mn.prototype.get=Hf,Mn.prototype.has=Gf,Mn.prototype.set=Qf;function il(e,n){var t=H(e),r=!t&&At(e),i=!t&&!r&&pt(e),a=!t&&!r&&!i&&Xt(e),o=t||r||i||a,s=o?ru(e.length,rf):[],c=s.length;for(var _ in e)(n||we.call(e,_))&&!(o&&(_=="length"||i&&(_=="offset"||_=="parent")||a&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Xn(_,c)))&&s.push(_);return s}function ul(e){var n=e.length;return n?e[yu(0,n-1)]:l}function Kf(e,n){return di(on(e),Pt(n,0,e.length))}function Zf(e){return di(on(e))}function fu(e,n,t){(t!==l&&!On(e[n],t)||t===l&&!(n in e))&&Kn(e,n,t)}function pr(e,n,t){var r=e[n];(!(we.call(e,n)&&On(r,t))||t===l&&!(n in e))&&Kn(e,n,t)}function jr(e,n){for(var t=e.length;t--;)if(On(e[t][0],n))return t;return-1}function Jf(e,n,t,r){return st(e,function(i,a,o){n(r,i,t(i),o)}),r}function al(e,n){return e&&Yn(n,Ge(n),e)}function Xf(e,n){return e&&Yn(n,fn(n),e)}function Kn(e,n,t){n=="__proto__"&&Gr?Gr(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}function cu(e,n){for(var t=-1,r=n.length,i=v(r),a=e==null;++t<r;)i[t]=a?l:zu(e,n[t]);return i}function Pt(e,n,t){return e===e&&(t!==l&&(e=e<=t?e:t),n!==l&&(e=e>=n?e:n)),e}function Pn(e,n,t,r,i,a){var o,s=n&ve,c=n&N,_=n&D;if(t&&(o=i?t(e,r,i,a):t(e)),o!==l)return o;if(!Ce(e))return e;var w=H(e);if(w){if(o=Nc(e),!s)return on(e,o)}else{var b=nn(e),T=b==Te||b==je;if(pt(e))return Cl(e,s);if(b==kn||b==En||T&&!i){if(o=c||T?{}:Kl(e),!s)return c?Ec(e,Xf(o,e)):Tc(e,al(o,e))}else{if(!De[b])return i?e:{};o=Yc(e,b,s)}}a||(a=new Mn);var L=a.get(e);if(L)return L;a.set(e,o),So(e)?e.forEach(function(W){o.add(Pn(W,n,t,W,e,a))}):Po(e)&&e.forEach(function(W,te){o.set(te,Pn(W,n,t,te,e,a))});var B=_?c?ku:Cu:c?fn:Ge,X=w?l:B(e);return yn(X||e,function(W,te){X&&(te=W,W=e[te]),pr(o,te,Pn(W,n,t,te,e,a))}),o}function jf(e){var n=Ge(e);return function(t){return ll(t,e,n)}}function ll(e,n,t){var r=t.length;if(e==null)return!r;for(e=ye(e);r--;){var i=t[r],a=n[i],o=e[i];if(o===l&&!(i in e)||!a(o))return!1}return!0}function ol(e,n,t){if(typeof e!="function")throw new Dn(U);return yr(function(){e.apply(l,t)},n)}function vr(e,n,t,r){var i=-1,a=Fr,o=!0,s=e.length,c=[],_=n.length;if(!s)return c;t&&(n=Re(n,vn(t))),r?(a=Ji,o=!1):n.length>=P&&(a=lr,o=!1,n=new bt(n));e:for(;++i<s;){var w=e[i],b=t==null?w:t(w);if(w=r||w!==0?w:0,o&&b===b){for(var T=_;T--;)if(n[T]===b)continue e;c.push(w)}else a(n,b,r)||c.push(w)}return c}var st=Ol(Nn),sl=Ol(pu,!0);function ec(e,n){var t=!0;return st(e,function(r,i,a){return t=!!n(r,i,a),t}),t}function ei(e,n,t){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=n(a);if(o!=null&&(s===l?o===o&&!gn(o):t(o,s)))var s=o,c=a}return c}function nc(e,n,t,r){var i=e.length;for(t=Z(t),t<0&&(t=-t>i?0:i+t),r=r===l||r>i?i:Z(r),r<0&&(r+=i),r=t>r?0:Ao(r);t<r;)e[t++]=n;return e}function fl(e,n){var t=[];return st(e,function(r,i,a){n(r,i,a)&&t.push(r)}),t}function Xe(e,n,t,r,i){var a=-1,o=e.length;for(t||(t=Wc),i||(i=[]);++a<o;){var s=e[a];n>0&&t(s)?n>1?Xe(s,n-1,t,r,i):at(i,s):r||(i[i.length]=s)}return i}var du=Fl(),cl=Fl(!0);function Nn(e,n){return e&&du(e,n,Ge)}function pu(e,n){return e&&cl(e,n,Ge)}function ni(e,n){return ut(n,function(t){return jn(e[t])})}function xt(e,n){n=ct(n,e);for(var t=0,r=n.length;e!=null&&t<r;)e=e[Bn(n[t++])];return t&&t==r?e:l}function dl(e,n,t){var r=n(e);return H(e)?r:at(r,t(e))}function un(e){return e==null?e===l?Ri:Mt:yt&&yt in ye(e)?Vc(e):Zc(e)}function vu(e,n){return e>n}function tc(e,n){return e!=null&&we.call(e,n)}function rc(e,n){return e!=null&&n in ye(e)}function ic(e,n,t){return e>=en(n,t)&&e<He(n,t)}function hu(e,n,t){for(var r=t?Ji:Fr,i=e[0].length,a=e.length,o=a,s=v(a),c=1/0,_=[];o--;){var w=e[o];o&&n&&(w=Re(w,vn(n))),c=en(w.length,c),s[o]=!t&&(n||i>=120&&w.length>=120)?new bt(o&&w):l}w=e[0];var b=-1,T=s[0];e:for(;++b<i&&_.length<c;){var L=w[b],B=n?n(L):L;if(L=t||L!==0?L:0,!(T?lr(T,B):r(_,B,t))){for(o=a;--o;){var X=s[o];if(!(X?lr(X,B):r(e[o],B,t)))continue e}T&&T.push(B),_.push(L)}}return _}function uc(e,n,t,r){return Nn(e,function(i,a,o){n(r,t(i),a,o)}),r}function hr(e,n,t){n=ct(n,e),e=jl(e,n);var r=e==null?e:e[Bn(Sn(n))];return r==null?l:pn(r,e,t)}function pl(e){return Ie(e)&&un(e)==En}function ac(e){return Ie(e)&&un(e)==rt}function lc(e){return Ie(e)&&un(e)==Un}function gr(e,n,t,r,i){return e===n?!0:e==null||n==null||!Ie(e)&&!Ie(n)?e!==e&&n!==n:oc(e,n,t,r,gr,i)}function oc(e,n,t,r,i,a){var o=H(e),s=H(n),c=o?$n:nn(e),_=s?$n:nn(n);c=c==En?kn:c,_=_==En?kn:_;var w=c==kn,b=_==kn,T=c==_;if(T&&pt(e)){if(!pt(n))return!1;o=!0,w=!1}if(T&&!w)return a||(a=new Mn),o||Xt(e)?Hl(e,n,t,r,i,a):Oc(e,n,c,t,r,i,a);if(!(t&I)){var L=w&&we.call(e,"__wrapped__"),B=b&&we.call(n,"__wrapped__");if(L||B){var X=L?e.value():e,W=B?n.value():n;return a||(a=new Mn),i(X,W,t,r,a)}}return T?(a||(a=new Mn),Fc(e,n,t,r,i,a)):!1}function sc(e){return Ie(e)&&nn(e)==Ne}function gu(e,n,t,r){var i=t.length,a=i,o=!r;if(e==null)return!a;for(e=ye(e);i--;){var s=t[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){s=t[i];var c=s[0],_=e[c],w=s[1];if(o&&s[2]){if(_===l&&!(c in e))return!1}else{var b=new Mn;if(r)var T=r(_,w,c,e,n,b);if(!(T===l?gr(w,_,I|j,r,b):T))return!1}}return!0}function vl(e){if(!Ce(e)||zc(e))return!1;var n=jn(e)?sf:d;return n.test(Rt(e))}function fc(e){return Ie(e)&&un(e)==Hn}function cc(e){return Ie(e)&&nn(e)==dn}function dc(e){return Ie(e)&&_i(e.length)&&!!xe[un(e)]}function hl(e){return typeof e=="function"?e:e==null?cn:typeof e=="object"?H(e)?_l(e[0],e[1]):ml(e):Uo(e)}function mu(e){if(!wr(e))return hf(e);var n=[];for(var t in ye(e))we.call(e,t)&&t!="constructor"&&n.push(t);return n}function pc(e){if(!Ce(e))return Kc(e);var n=wr(e),t=[];for(var r in e)r=="constructor"&&(n||!we.call(e,r))||t.push(r);return t}function _u(e,n){return e<n}function gl(e,n){var t=-1,r=sn(e)?v(e.length):[];return st(e,function(i,a,o){r[++t]=n(i,a,o)}),r}function ml(e){var n=Lu(e);return n.length==1&&n[0][2]?Jl(n[0][0],n[0][1]):function(t){return t===e||gu(t,e,n)}}function _l(e,n){return Ou(e)&&Zl(n)?Jl(Bn(e),n):function(t){var r=zu(t,e);return r===l&&r===n?Hu(t,e):gr(n,r,I|j)}}function ti(e,n,t,r,i){e!==n&&du(n,function(a,o){if(i||(i=new Mn),Ce(a))vc(e,n,o,t,ti,r,i);else{var s=r?r(Vu(e,o),a,o+"",e,n,i):l;s===l&&(s=a),fu(e,o,s)}},fn)}function vc(e,n,t,r,i,a,o){var s=Vu(e,t),c=Vu(n,t),_=o.get(c);if(_){fu(e,t,_);return}var w=a?a(s,c,t+"",e,n,o):l,b=w===l;if(b){var T=H(c),L=!T&&pt(c),B=!T&&!L&&Xt(c);w=c,T||L||B?H(s)?w=s:Fe(s)?w=on(s):L?(b=!1,w=Cl(c,!0)):B?(b=!1,w=kl(c,!0)):w=[]:Dr(c)||At(c)?(w=s,At(s)?w=To(s):(!Ce(s)||jn(s))&&(w=Kl(c))):b=!1}b&&(o.set(c,w),i(w,c,r,a,o),o.delete(c)),fu(e,t,w)}function wl(e,n){var t=e.length;if(!!t)return n+=n<0?t:0,Xn(n,t)?e[n]:l}function yl(e,n,t){n.length?n=Re(n,function(a){return H(a)?function(o){return xt(o,a.length===1?a[0]:a)}:a}):n=[cn];var r=-1;n=Re(n,vn(Y()));var i=gl(e,function(a,o,s){var c=Re(n,function(_){return _(a)});return{criteria:c,index:++r,value:a}});return Ns(i,function(a,o){return Ac(a,o,t)})}function hc(e,n){return Dl(e,n,function(t,r){return Hu(e,r)})}function Dl(e,n,t){for(var r=-1,i=n.length,a={};++r<i;){var o=n[r],s=xt(e,o);t(s,o)&&mr(a,ct(o,e),s)}return a}function gc(e){return function(n){return xt(n,e)}}function wu(e,n,t,r){var i=r?qs:Yt,a=-1,o=n.length,s=e;for(e===n&&(n=on(n)),t&&(s=Re(e,vn(t)));++a<o;)for(var c=0,_=n[a],w=t?t(_):_;(c=i(s,w,c,r))>-1;)s!==e&&Hr.call(s,c,1),Hr.call(e,c,1);return e}function bl(e,n){for(var t=e?n.length:0,r=t-1;t--;){var i=n[t];if(t==r||i!==a){var a=i;Xn(i)?Hr.call(e,i,1):Pu(e,i)}}return e}function yu(e,n){return e+Kr(tl()*(n-e+1))}function mc(e,n,t,r){for(var i=-1,a=He(Qr((n-e)/(t||1)),0),o=v(a);a--;)o[r?a:++i]=e,e+=t;return o}function Du(e,n){var t="";if(!e||n<1||n>J)return t;do n%2&&(t+=e),n=Kr(n/2),n&&(e+=e);while(n);return t}function ee(e,n){return Uu(Xl(e,n,cn),e+"")}function _c(e){return ul(jt(e))}function wc(e,n){var t=jt(e);return di(t,Pt(n,0,t.length))}function mr(e,n,t,r){if(!Ce(e))return e;n=ct(n,e);for(var i=-1,a=n.length,o=a-1,s=e;s!=null&&++i<a;){var c=Bn(n[i]),_=t;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=o){var w=s[c];_=r?r(w,c,s):l,_===l&&(_=Ce(w)?w:Xn(n[i+1])?[]:{})}pr(s,c,_),s=s[c]}return e}var Pl=Zr?function(e,n){return Zr.set(e,n),e}:cn,yc=Gr?function(e,n){return Gr(e,"toString",{configurable:!0,enumerable:!1,value:Qu(n),writable:!0})}:cn;function Dc(e){return di(jt(e))}function xn(e,n,t){var r=-1,i=e.length;n<0&&(n=-n>i?0:i+n),t=t>i?i:t,t<0&&(t+=i),i=n>t?0:t-n>>>0,n>>>=0;for(var a=v(i);++r<i;)a[r]=e[r+n];return a}function bc(e,n){var t;return st(e,function(r,i,a){return t=n(r,i,a),!t}),!!t}function ri(e,n,t){var r=0,i=e==null?r:e.length;if(typeof n=="number"&&n===n&&i<=Et){for(;r<i;){var a=r+i>>>1,o=e[a];o!==null&&!gn(o)&&(t?o<=n:o<n)?r=a+1:i=a}return i}return bu(e,n,cn,t)}function bu(e,n,t,r){var i=0,a=e==null?0:e.length;if(a===0)return 0;n=t(n);for(var o=n!==n,s=n===null,c=gn(n),_=n===l;i<a;){var w=Kr((i+a)/2),b=t(e[w]),T=b!==l,L=b===null,B=b===b,X=gn(b);if(o)var W=r||B;else _?W=B&&(r||T):s?W=B&&T&&(r||!L):c?W=B&&T&&!L&&(r||!X):L||X?W=!1:W=r?b<=n:b<n;W?i=w+1:a=w}return en(a,ht)}function xl(e,n){for(var t=-1,r=e.length,i=0,a=[];++t<r;){var o=e[t],s=n?n(o):o;if(!t||!On(s,c)){var c=s;a[i++]=o===0?0:o}}return a}function Sl(e){return typeof e=="number"?e:gn(e)?tt:+e}function hn(e){if(typeof e=="string")return e;if(H(e))return Re(e,hn)+"";if(gn(e))return rl?rl.call(e):"";var n=e+"";return n=="0"&&1/e==-Q?"-0":n}function ft(e,n,t){var r=-1,i=Fr,a=e.length,o=!0,s=[],c=s;if(t)o=!1,i=Ji;else if(a>=P){var _=n?null:Lc(e);if(_)return Ur(_);o=!1,i=lr,c=new bt}else c=n?[]:s;e:for(;++r<a;){var w=e[r],b=n?n(w):w;if(w=t||w!==0?w:0,o&&b===b){for(var T=c.length;T--;)if(c[T]===b)continue e;n&&c.push(b),s.push(w)}else i(c,b,t)||(c!==s&&c.push(b),s.push(w))}return s}function Pu(e,n){return n=ct(n,e),e=jl(e,n),e==null||delete e[Bn(Sn(n))]}function Rl(e,n,t,r){return mr(e,n,t(xt(e,n)),r)}function ii(e,n,t,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&n(e[a],a,e););return t?xn(e,r?0:a,r?a+1:i):xn(e,r?a+1:0,r?i:a)}function Al(e,n){var t=e;return t instanceof ie&&(t=t.value()),Xi(n,function(r,i){return i.func.apply(i.thisArg,at([r],i.args))},t)}function xu(e,n,t){var r=e.length;if(r<2)return r?ft(e[0]):[];for(var i=-1,a=v(r);++i<r;)for(var o=e[i],s=-1;++s<r;)s!=i&&(a[i]=vr(a[i]||o,e[s],n,t));return ft(Xe(a,1),n,t)}function Tl(e,n,t){for(var r=-1,i=e.length,a=n.length,o={};++r<i;){var s=r<a?n[r]:l;t(o,e[r],s)}return o}function Su(e){return Fe(e)?e:[]}function Ru(e){return typeof e=="function"?e:cn}function ct(e,n){return H(e)?e:Ou(e,n)?[e]:ro(me(e))}var Pc=ee;function dt(e,n,t){var r=e.length;return t=t===l?r:t,!n&&t>=r?e:xn(e,n,t)}var El=ff||function(e){return Je.clearTimeout(e)};function Cl(e,n){if(n)return e.slice();var t=e.length,r=Ja?Ja(t):new e.constructor(t);return e.copy(r),r}function Au(e){var n=new e.constructor(e.byteLength);return new $r(n).set(new $r(e)),n}function xc(e,n){var t=n?Au(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}function Sc(e){var n=new e.constructor(e.source,Mr.exec(e));return n.lastIndex=e.lastIndex,n}function Rc(e){return dr?ye(dr.call(e)):{}}function kl(e,n){var t=n?Au(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function Il(e,n){if(e!==n){var t=e!==l,r=e===null,i=e===e,a=gn(e),o=n!==l,s=n===null,c=n===n,_=gn(n);if(!s&&!_&&!a&&e>n||a&&o&&c&&!s&&!_||r&&o&&c||!t&&c||!i)return 1;if(!r&&!a&&!_&&e<n||_&&t&&i&&!r&&!a||s&&t&&i||!o&&i||!c)return-1}return 0}function Ac(e,n,t){for(var r=-1,i=e.criteria,a=n.criteria,o=i.length,s=t.length;++r<o;){var c=Il(i[r],a[r]);if(c){if(r>=s)return c;var _=t[r];return c*(_=="desc"?-1:1)}}return e.index-n.index}function Ll(e,n,t,r){for(var i=-1,a=e.length,o=t.length,s=-1,c=n.length,_=He(a-o,0),w=v(c+_),b=!r;++s<c;)w[s]=n[s];for(;++i<o;)(b||i<a)&&(w[t[i]]=e[i]);for(;_--;)w[s++]=e[i++];return w}function Ml(e,n,t,r){for(var i=-1,a=e.length,o=-1,s=t.length,c=-1,_=n.length,w=He(a-s,0),b=v(w+_),T=!r;++i<w;)b[i]=e[i];for(var L=i;++c<_;)b[L+c]=n[c];for(;++o<s;)(T||i<a)&&(b[L+t[o]]=e[i++]);return b}function on(e,n){var t=-1,r=e.length;for(n||(n=v(r));++t<r;)n[t]=e[t];return n}function Yn(e,n,t,r){var i=!t;t||(t={});for(var a=-1,o=n.length;++a<o;){var s=n[a],c=r?r(t[s],e[s],s,t,e):l;c===l&&(c=e[s]),i?Kn(t,s,c):pr(t,s,c)}return t}function Tc(e,n){return Yn(e,Mu(e),n)}function Ec(e,n){return Yn(e,Gl(e),n)}function ui(e,n){return function(t,r){var i=H(t)?Ls:Jf,a=n?n():{};return i(t,e,Y(r,2),a)}}function Kt(e){return ee(function(n,t){var r=-1,i=t.length,a=i>1?t[i-1]:l,o=i>2?t[2]:l;for(a=e.length>3&&typeof a=="function"?(i--,a):l,o&&an(t[0],t[1],o)&&(a=i<3?l:a,i=1),n=ye(n);++r<i;){var s=t[r];s&&e(n,s,r,a)}return n})}function Ol(e,n){return function(t,r){if(t==null)return t;if(!sn(t))return e(t,r);for(var i=t.length,a=n?i:-1,o=ye(t);(n?a--:++a<i)&&r(o[a],a,o)!==!1;);return t}}function Fl(e){return function(n,t,r){for(var i=-1,a=ye(n),o=r(n),s=o.length;s--;){var c=o[e?s:++i];if(t(a[c],c,a)===!1)break}return n}}function Cc(e,n,t){var r=n&fe,i=_r(e);function a(){var o=this&&this!==Je&&this instanceof a?i:e;return o.apply(r?t:this,arguments)}return a}function Vl(e){return function(n){n=me(n);var t=Bt(n)?Ln(n):l,r=t?t[0]:n.charAt(0),i=t?dt(t,1).join(""):n.slice(1);return r[e]()+i}}function Zt(e){return function(n){return Xi(Fo(Oo(n).replace(ws,"")),e,"")}}function _r(e){return function(){var n=arguments;switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3]);case 5:return new e(n[0],n[1],n[2],n[3],n[4]);case 6:return new e(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var t=Qt(e.prototype),r=e.apply(t,n);return Ce(r)?r:t}}function kc(e,n,t){var r=_r(e);function i(){for(var a=arguments.length,o=v(a),s=a,c=Jt(i);s--;)o[s]=arguments[s];var _=a<3&&o[0]!==c&&o[a-1]!==c?[]:lt(o,c);if(a-=_.length,a<t)return Bl(e,n,ai,i.placeholder,l,o,_,l,l,t-a);var w=this&&this!==Je&&this instanceof i?r:e;return pn(w,this,o)}return i}function Ul(e){return function(n,t,r){var i=ye(n);if(!sn(n)){var a=Y(t,3);n=Ge(n),t=function(s){return a(i[s],s,i)}}var o=e(n,t,r);return o>-1?i[a?n[o]:o]:l}}function ql(e){return Jn(function(n){var t=n.length,r=t,i=bn.prototype.thru;for(e&&n.reverse();r--;){var a=n[r];if(typeof a!="function")throw new Dn(U);if(i&&!o&&fi(a)=="wrapper")var o=new bn([],!0)}for(r=o?r:t;++r<t;){a=n[r];var s=fi(a),c=s=="wrapper"?Iu(a):l;c&&Fu(c[0])&&c[1]==(Oe|ae|Be|rn)&&!c[4].length&&c[9]==1?o=o[fi(c[0])].apply(o,c[3]):o=a.length==1&&Fu(a)?o[s]():o.thru(a)}return function(){var _=arguments,w=_[0];if(o&&_.length==1&&H(w))return o.plant(w).value();for(var b=0,T=t?n[b].apply(this,_):w;++b<t;)T=n[b].call(this,T);return T}})}function ai(e,n,t,r,i,a,o,s,c,_){var w=n&Oe,b=n&fe,T=n&K,L=n&(ae|Pe),B=n&We,X=T?l:_r(e);function W(){for(var te=arguments.length,oe=v(te),mn=te;mn--;)oe[mn]=arguments[mn];if(L)var ln=Jt(W),_n=Bs(oe,ln);if(r&&(oe=Ll(oe,r,i,L)),a&&(oe=Ml(oe,a,o,L)),te-=_n,L&&te<_){var Ve=lt(oe,ln);return Bl(e,n,ai,W.placeholder,t,oe,Ve,s,c,_-te)}var Fn=b?t:this,nt=T?Fn[e]:e;return te=oe.length,s?oe=Jc(oe,s):B&&te>1&&oe.reverse(),w&&c<te&&(oe.length=c),this&&this!==Je&&this instanceof W&&(nt=X||_r(nt)),nt.apply(Fn,oe)}return W}function Nl(e,n){return function(t,r){return uc(t,e,n(r),{})}}function li(e,n){return function(t,r){var i;if(t===l&&r===l)return n;if(t!==l&&(i=t),r!==l){if(i===l)return r;typeof t=="string"||typeof r=="string"?(t=hn(t),r=hn(r)):(t=Sl(t),r=Sl(r)),i=e(t,r)}return i}}function Tu(e){return Jn(function(n){return n=Re(n,vn(Y())),ee(function(t){var r=this;return e(n,function(i){return pn(i,r,t)})})})}function oi(e,n){n=n===l?" ":hn(n);var t=n.length;if(t<2)return t?Du(n,e):n;var r=Du(n,Qr(e/Wt(n)));return Bt(n)?dt(Ln(r),0,e).join(""):r.slice(0,e)}function Ic(e,n,t,r){var i=n&fe,a=_r(e);function o(){for(var s=-1,c=arguments.length,_=-1,w=r.length,b=v(w+c),T=this&&this!==Je&&this instanceof o?a:e;++_<w;)b[_]=r[_];for(;c--;)b[_++]=arguments[++s];return pn(T,i?t:this,b)}return o}function Yl(e){return function(n,t,r){return r&&typeof r!="number"&&an(n,t,r)&&(t=r=l),n=et(n),t===l?(t=n,n=0):t=et(t),r=r===l?n<t?1:-1:et(r),mc(n,t,r,e)}}function si(e){return function(n,t){return typeof n=="string"&&typeof t=="string"||(n=Rn(n),t=Rn(t)),e(n,t)}}function Bl(e,n,t,r,i,a,o,s,c,_){var w=n&ae,b=w?o:l,T=w?l:o,L=w?a:l,B=w?l:a;n|=w?Be:qe,n&=~(w?qe:Be),n&pe||(n&=~(fe|K));var X=[e,n,i,L,b,B,T,s,c,_],W=t.apply(l,X);return Fu(e)&&eo(W,X),W.placeholder=r,no(W,e,n)}function Eu(e){var n=ze[e];return function(t,r){if(t=Rn(t),r=r==null?0:en(Z(r),292),r&&nl(t)){var i=(me(t)+"e").split("e"),a=n(i[0]+"e"+(+i[1]+r));return i=(me(a)+"e").split("e"),+(i[0]+"e"+(+i[1]-r))}return n(t)}}var Lc=Ht&&1/Ur(new Ht([,-0]))[1]==Q?function(e){return new Ht(e)}:Ju;function Wl(e){return function(n){var t=nn(n);return t==Ne?uu(n):t==dn?Ks(n):Ys(n,e(n))}}function Zn(e,n,t,r,i,a,o,s){var c=n&K;if(!c&&typeof e!="function")throw new Dn(U);var _=r?r.length:0;if(_||(n&=~(Be|qe),r=i=l),o=o===l?o:He(Z(o),0),s=s===l?s:Z(s),_-=i?i.length:0,n&qe){var w=r,b=i;r=i=l}var T=c?l:Iu(e),L=[e,n,t,r,i,w,b,a,o,s];if(T&&Qc(L,T),e=L[0],n=L[1],t=L[2],r=L[3],i=L[4],s=L[9]=L[9]===l?c?0:e.length:He(L[9]-_,0),!s&&n&(ae|Pe)&&(n&=~(ae|Pe)),!n||n==fe)var B=Cc(e,n,t);else n==ae||n==Pe?B=kc(e,n,s):(n==Be||n==(fe|Be))&&!i.length?B=Ic(e,n,t,r):B=ai.apply(l,L);var X=T?Pl:eo;return no(X(B,L),e,n)}function $l(e,n,t,r){return e===l||On(e,zt[t])&&!we.call(r,t)?n:e}function zl(e,n,t,r,i,a){return Ce(e)&&Ce(n)&&(a.set(n,e),ti(e,n,l,zl,a),a.delete(n)),e}function Mc(e){return Dr(e)?l:e}function Hl(e,n,t,r,i,a){var o=t&I,s=e.length,c=n.length;if(s!=c&&!(o&&c>s))return!1;var _=a.get(e),w=a.get(n);if(_&&w)return _==n&&w==e;var b=-1,T=!0,L=t&j?new bt:l;for(a.set(e,n),a.set(n,e);++b<s;){var B=e[b],X=n[b];if(r)var W=o?r(X,B,b,n,e,a):r(B,X,b,e,n,a);if(W!==l){if(W)continue;T=!1;break}if(L){if(!ji(n,function(te,oe){if(!lr(L,oe)&&(B===te||i(B,te,t,r,a)))return L.push(oe)})){T=!1;break}}else if(!(B===X||i(B,X,t,r,a))){T=!1;break}}return a.delete(e),a.delete(n),T}function Oc(e,n,t,r,i,a,o){switch(t){case ge:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case rt:return!(e.byteLength!=n.byteLength||!a(new $r(e),new $r(n)));case zn:case Un:case Cn:return On(+e,+n);case Lt:return e.name==n.name&&e.message==n.message;case Hn:case gt:return e==n+"";case Ne:var s=uu;case dn:var c=r&I;if(s||(s=Ur),e.size!=n.size&&!c)return!1;var _=o.get(e);if(_)return _==n;r|=j,o.set(e,n);var w=Hl(s(e),s(n),r,i,a,o);return o.delete(e),w;case Ft:if(dr)return dr.call(e)==dr.call(n)}return!1}function Fc(e,n,t,r,i,a){var o=t&I,s=Cu(e),c=s.length,_=Cu(n),w=_.length;if(c!=w&&!o)return!1;for(var b=c;b--;){var T=s[b];if(!(o?T in n:we.call(n,T)))return!1}var L=a.get(e),B=a.get(n);if(L&&B)return L==n&&B==e;var X=!0;a.set(e,n),a.set(n,e);for(var W=o;++b<c;){T=s[b];var te=e[T],oe=n[T];if(r)var mn=o?r(oe,te,T,n,e,a):r(te,oe,T,e,n,a);if(!(mn===l?te===oe||i(te,oe,t,r,a):mn)){X=!1;break}W||(W=T=="constructor")}if(X&&!W){var ln=e.constructor,_n=n.constructor;ln!=_n&&"constructor"in e&&"constructor"in n&&!(typeof ln=="function"&&ln instanceof ln&&typeof _n=="function"&&_n instanceof _n)&&(X=!1)}return a.delete(e),a.delete(n),X}function Jn(e){return Uu(Xl(e,l,lo),e+"")}function Cu(e){return dl(e,Ge,Mu)}function ku(e){return dl(e,fn,Gl)}var Iu=Zr?function(e){return Zr.get(e)}:Ju;function fi(e){for(var n=e.name+"",t=Gt[n],r=we.call(Gt,n)?t.length:0;r--;){var i=t[r],a=i.func;if(a==null||a==e)return i.name}return n}function Jt(e){var n=we.call(u,"placeholder")?u:e;return n.placeholder}function Y(){var e=u.iteratee||Ku;return e=e===Ku?hl:e,arguments.length?e(arguments[0],arguments[1]):e}function ci(e,n){var t=e.__data__;return $c(n)?t[typeof n=="string"?"string":"hash"]:t.map}function Lu(e){for(var n=Ge(e),t=n.length;t--;){var r=n[t],i=e[r];n[t]=[r,i,Zl(i)]}return n}function St(e,n){var t=Hs(e,n);return vl(t)?t:l}function Vc(e){var n=we.call(e,yt),t=e[yt];try{e[yt]=l;var r=!0}catch{}var i=Br.call(e);return r&&(n?e[yt]=t:delete e[yt]),i}var Mu=lu?function(e){return e==null?[]:(e=ye(e),ut(lu(e),function(n){return ja.call(e,n)}))}:Xu,Gl=lu?function(e){for(var n=[];e;)at(n,Mu(e)),e=zr(e);return n}:Xu,nn=un;(ou&&nn(new ou(new ArrayBuffer(1)))!=ge||sr&&nn(new sr)!=Ne||su&&nn(su.resolve())!=Ot||Ht&&nn(new Ht)!=dn||fr&&nn(new fr)!=mt)&&(nn=function(e){var n=un(e),t=n==kn?e.constructor:l,r=t?Rt(t):"";if(r)switch(r){case wf:return ge;case yf:return Ne;case Df:return Ot;case bf:return dn;case Pf:return mt}return n});function Uc(e,n,t){for(var r=-1,i=t.length;++r<i;){var a=t[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":n-=o;break;case"take":n=en(n,e+o);break;case"takeRight":e=He(e,n-o);break}}return{start:e,end:n}}function qc(e){var n=e.match(Fi);return n?n[1].split(Vi):[]}function Ql(e,n,t){n=ct(n,e);for(var r=-1,i=n.length,a=!1;++r<i;){var o=Bn(n[r]);if(!(a=e!=null&&t(e,o)))break;e=e[o]}return a||++r!=i?a:(i=e==null?0:e.length,!!i&&_i(i)&&Xn(o,i)&&(H(e)||At(e)))}function Nc(e){var n=e.length,t=new e.constructor(n);return n&&typeof e[0]=="string"&&we.call(e,"index")&&(t.index=e.index,t.input=e.input),t}function Kl(e){return typeof e.constructor=="function"&&!wr(e)?Qt(zr(e)):{}}function Yc(e,n,t){var r=e.constructor;switch(n){case rt:return Au(e);case zn:case Un:return new r(+e);case ge:return xc(e,t);case In:case it:case _t:case Ee:case Ke:case rr:case ir:case Vt:case ur:return kl(e,t);case Ne:return new r;case Cn:case gt:return new r(e);case Hn:return Sc(e);case dn:return new r;case Ft:return Rc(e)}}function Bc(e,n){var t=n.length;if(!t)return e;var r=t-1;return n[r]=(t>1?"& ":"")+n[r],n=n.join(t>2?", ":" "),e.replace(Lr,`{
/* [wrapped with `+n+`] */
`)}function Wc(e){return H(e)||At(e)||!!(el&&e&&e[el])}function Xn(e,n){var t=typeof e;return n=n==null?J:n,!!n&&(t=="number"||t!="symbol"&&p.test(e))&&e>-1&&e%1==0&&e<n}function an(e,n,t){if(!Ce(t))return!1;var r=typeof n;return(r=="number"?sn(t)&&Xn(n,t.length):r=="string"&&n in t)?On(t[n],e):!1}function Ou(e,n){if(H(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||gn(e)?!0:Mi.test(e)||!Li.test(e)||n!=null&&e in ye(n)}function $c(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function Fu(e){var n=fi(e),t=u[n];if(typeof t!="function"||!(n in ie.prototype))return!1;if(e===t)return!0;var r=Iu(t);return!!r&&e===r[0]}function zc(e){return!!Za&&Za in e}var Hc=Nr?jn:ju;function wr(e){var n=e&&e.constructor,t=typeof n=="function"&&n.prototype||zt;return e===t}function Zl(e){return e===e&&!Ce(e)}function Jl(e,n){return function(t){return t==null?!1:t[e]===n&&(n!==l||e in ye(t))}}function Gc(e){var n=gi(e,function(r){return t.size===Se&&t.clear(),r}),t=n.cache;return n}function Qc(e,n){var t=e[1],r=n[1],i=t|r,a=i<(fe|K|Oe),o=r==Oe&&t==ae||r==Oe&&t==rn&&e[7].length<=n[8]||r==(Oe|rn)&&n[7].length<=n[8]&&t==ae;if(!(a||o))return e;r&fe&&(e[2]=n[2],i|=t&fe?0:pe);var s=n[3];if(s){var c=e[3];e[3]=c?Ll(c,s,n[4]):s,e[4]=c?lt(e[3],G):n[4]}return s=n[5],s&&(c=e[5],e[5]=c?Ml(c,s,n[6]):s,e[6]=c?lt(e[5],G):n[6]),s=n[7],s&&(e[7]=s),r&Oe&&(e[8]=e[8]==null?n[8]:en(e[8],n[8])),e[9]==null&&(e[9]=n[9]),e[0]=n[0],e[1]=i,e}function Kc(e){var n=[];if(e!=null)for(var t in ye(e))n.push(t);return n}function Zc(e){return Br.call(e)}function Xl(e,n,t){return n=He(n===l?e.length-1:n,0),function(){for(var r=arguments,i=-1,a=He(r.length-n,0),o=v(a);++i<a;)o[i]=r[n+i];i=-1;for(var s=v(n+1);++i<n;)s[i]=r[i];return s[n]=t(o),pn(e,this,s)}}function jl(e,n){return n.length<2?e:xt(e,xn(n,0,-1))}function Jc(e,n){for(var t=e.length,r=en(n.length,t),i=on(e);r--;){var a=n[r];e[r]=Xn(a,t)?i[a]:l}return e}function Vu(e,n){if(!(n==="constructor"&&typeof e[n]=="function")&&n!="__proto__")return e[n]}var eo=to(Pl),yr=df||function(e,n){return Je.setTimeout(e,n)},Uu=to(yc);function no(e,n,t){var r=n+"";return Uu(e,Bc(r,Xc(qc(r),t)))}function to(e){var n=0,t=0;return function(){var r=gf(),i=y-(r-t);if(t=r,i>0){if(++n>=M)return arguments[0]}else n=0;return e.apply(l,arguments)}}function di(e,n){var t=-1,r=e.length,i=r-1;for(n=n===l?r:n;++t<n;){var a=yu(t,i),o=e[a];e[a]=e[t],e[t]=o}return e.length=n,e}var ro=Gc(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Ut,function(t,r,i,a){n.push(i?a.replace(Ni,"$1"):r||t)}),n});function Bn(e){if(typeof e=="string"||gn(e))return e;var n=e+"";return n=="0"&&1/e==-Q?"-0":n}function Rt(e){if(e!=null){try{return Yr.call(e)}catch{}try{return e+""}catch{}}return""}function Xc(e,n){return yn(Ct,function(t){var r="_."+t[0];n&t[1]&&!Fr(e,r)&&e.push(r)}),e.sort()}function io(e){if(e instanceof ie)return e.clone();var n=new bn(e.__wrapped__,e.__chain__);return n.__actions__=on(e.__actions__),n.__index__=e.__index__,n.__values__=e.__values__,n}function jc(e,n,t){(t?an(e,n,t):n===l)?n=1:n=He(Z(n),0);var r=e==null?0:e.length;if(!r||n<1)return[];for(var i=0,a=0,o=v(Qr(r/n));i<r;)o[a++]=xn(e,i,i+=n);return o}function ed(e){for(var n=-1,t=e==null?0:e.length,r=0,i=[];++n<t;){var a=e[n];a&&(i[r++]=a)}return i}function nd(){var e=arguments.length;if(!e)return[];for(var n=v(e-1),t=arguments[0],r=e;r--;)n[r-1]=arguments[r];return at(H(t)?on(t):[t],Xe(n,1))}var td=ee(function(e,n){return Fe(e)?vr(e,Xe(n,1,Fe,!0)):[]}),rd=ee(function(e,n){var t=Sn(n);return Fe(t)&&(t=l),Fe(e)?vr(e,Xe(n,1,Fe,!0),Y(t,2)):[]}),id=ee(function(e,n){var t=Sn(n);return Fe(t)&&(t=l),Fe(e)?vr(e,Xe(n,1,Fe,!0),l,t):[]});function ud(e,n,t){var r=e==null?0:e.length;return r?(n=t||n===l?1:Z(n),xn(e,n<0?0:n,r)):[]}function ad(e,n,t){var r=e==null?0:e.length;return r?(n=t||n===l?1:Z(n),n=r-n,xn(e,0,n<0?0:n)):[]}function ld(e,n){return e&&e.length?ii(e,Y(n,3),!0,!0):[]}function od(e,n){return e&&e.length?ii(e,Y(n,3),!0):[]}function sd(e,n,t,r){var i=e==null?0:e.length;return i?(t&&typeof t!="number"&&an(e,n,t)&&(t=0,r=i),nc(e,n,t,r)):[]}function uo(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var i=t==null?0:Z(t);return i<0&&(i=He(r+i,0)),Vr(e,Y(n,3),i)}function ao(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var i=r-1;return t!==l&&(i=Z(t),i=t<0?He(r+i,0):en(i,r-1)),Vr(e,Y(n,3),i,!0)}function lo(e){var n=e==null?0:e.length;return n?Xe(e,1):[]}function fd(e){var n=e==null?0:e.length;return n?Xe(e,Q):[]}function cd(e,n){var t=e==null?0:e.length;return t?(n=n===l?1:Z(n),Xe(e,n)):[]}function dd(e){for(var n=-1,t=e==null?0:e.length,r={};++n<t;){var i=e[n];r[i[0]]=i[1]}return r}function oo(e){return e&&e.length?e[0]:l}function pd(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var i=t==null?0:Z(t);return i<0&&(i=He(r+i,0)),Yt(e,n,i)}function vd(e){var n=e==null?0:e.length;return n?xn(e,0,-1):[]}var hd=ee(function(e){var n=Re(e,Su);return n.length&&n[0]===e[0]?hu(n):[]}),gd=ee(function(e){var n=Sn(e),t=Re(e,Su);return n===Sn(t)?n=l:t.pop(),t.length&&t[0]===e[0]?hu(t,Y(n,2)):[]}),md=ee(function(e){var n=Sn(e),t=Re(e,Su);return n=typeof n=="function"?n:l,n&&t.pop(),t.length&&t[0]===e[0]?hu(t,l,n):[]});function _d(e,n){return e==null?"":vf.call(e,n)}function Sn(e){var n=e==null?0:e.length;return n?e[n-1]:l}function wd(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var i=r;return t!==l&&(i=Z(t),i=i<0?He(r+i,0):en(i,r-1)),n===n?Js(e,n,i):Vr(e,Ba,i,!0)}function yd(e,n){return e&&e.length?wl(e,Z(n)):l}var Dd=ee(so);function so(e,n){return e&&e.length&&n&&n.length?wu(e,n):e}function bd(e,n,t){return e&&e.length&&n&&n.length?wu(e,n,Y(t,2)):e}function Pd(e,n,t){return e&&e.length&&n&&n.length?wu(e,n,l,t):e}var xd=Jn(function(e,n){var t=e==null?0:e.length,r=cu(e,n);return bl(e,Re(n,function(i){return Xn(i,t)?+i:i}).sort(Il)),r});function Sd(e,n){var t=[];if(!(e&&e.length))return t;var r=-1,i=[],a=e.length;for(n=Y(n,3);++r<a;){var o=e[r];n(o,r,e)&&(t.push(o),i.push(r))}return bl(e,i),t}function qu(e){return e==null?e:_f.call(e)}function Rd(e,n,t){var r=e==null?0:e.length;return r?(t&&typeof t!="number"&&an(e,n,t)?(n=0,t=r):(n=n==null?0:Z(n),t=t===l?r:Z(t)),xn(e,n,t)):[]}function Ad(e,n){return ri(e,n)}function Td(e,n,t){return bu(e,n,Y(t,2))}function Ed(e,n){var t=e==null?0:e.length;if(t){var r=ri(e,n);if(r<t&&On(e[r],n))return r}return-1}function Cd(e,n){return ri(e,n,!0)}function kd(e,n,t){return bu(e,n,Y(t,2),!0)}function Id(e,n){var t=e==null?0:e.length;if(t){var r=ri(e,n,!0)-1;if(On(e[r],n))return r}return-1}function Ld(e){return e&&e.length?xl(e):[]}function Md(e,n){return e&&e.length?xl(e,Y(n,2)):[]}function Od(e){var n=e==null?0:e.length;return n?xn(e,1,n):[]}function Fd(e,n,t){return e&&e.length?(n=t||n===l?1:Z(n),xn(e,0,n<0?0:n)):[]}function Vd(e,n,t){var r=e==null?0:e.length;return r?(n=t||n===l?1:Z(n),n=r-n,xn(e,n<0?0:n,r)):[]}function Ud(e,n){return e&&e.length?ii(e,Y(n,3),!1,!0):[]}function qd(e,n){return e&&e.length?ii(e,Y(n,3)):[]}var Nd=ee(function(e){return ft(Xe(e,1,Fe,!0))}),Yd=ee(function(e){var n=Sn(e);return Fe(n)&&(n=l),ft(Xe(e,1,Fe,!0),Y(n,2))}),Bd=ee(function(e){var n=Sn(e);return n=typeof n=="function"?n:l,ft(Xe(e,1,Fe,!0),l,n)});function Wd(e){return e&&e.length?ft(e):[]}function $d(e,n){return e&&e.length?ft(e,Y(n,2)):[]}function zd(e,n){return n=typeof n=="function"?n:l,e&&e.length?ft(e,l,n):[]}function Nu(e){if(!(e&&e.length))return[];var n=0;return e=ut(e,function(t){if(Fe(t))return n=He(t.length,n),!0}),ru(n,function(t){return Re(e,eu(t))})}function fo(e,n){if(!(e&&e.length))return[];var t=Nu(e);return n==null?t:Re(t,function(r){return pn(n,l,r)})}var Hd=ee(function(e,n){return Fe(e)?vr(e,n):[]}),Gd=ee(function(e){return xu(ut(e,Fe))}),Qd=ee(function(e){var n=Sn(e);return Fe(n)&&(n=l),xu(ut(e,Fe),Y(n,2))}),Kd=ee(function(e){var n=Sn(e);return n=typeof n=="function"?n:l,xu(ut(e,Fe),l,n)}),Zd=ee(Nu);function Jd(e,n){return Tl(e||[],n||[],pr)}function Xd(e,n){return Tl(e||[],n||[],mr)}var jd=ee(function(e){var n=e.length,t=n>1?e[n-1]:l;return t=typeof t=="function"?(e.pop(),t):l,fo(e,t)});function co(e){var n=u(e);return n.__chain__=!0,n}function ep(e,n){return n(e),e}function pi(e,n){return n(e)}var np=Jn(function(e){var n=e.length,t=n?e[0]:0,r=this.__wrapped__,i=function(a){return cu(a,e)};return n>1||this.__actions__.length||!(r instanceof ie)||!Xn(t)?this.thru(i):(r=r.slice(t,+t+(n?1:0)),r.__actions__.push({func:pi,args:[i],thisArg:l}),new bn(r,this.__chain__).thru(function(a){return n&&!a.length&&a.push(l),a}))});function tp(){return co(this)}function rp(){return new bn(this.value(),this.__chain__)}function ip(){this.__values__===l&&(this.__values__=Ro(this.value()));var e=this.__index__>=this.__values__.length,n=e?l:this.__values__[this.__index__++];return{done:e,value:n}}function up(){return this}function ap(e){for(var n,t=this;t instanceof Xr;){var r=io(t);r.__index__=0,r.__values__=l,n?i.__wrapped__=r:n=r;var i=r;t=t.__wrapped__}return i.__wrapped__=e,n}function lp(){var e=this.__wrapped__;if(e instanceof ie){var n=e;return this.__actions__.length&&(n=new ie(this)),n=n.reverse(),n.__actions__.push({func:pi,args:[qu],thisArg:l}),new bn(n,this.__chain__)}return this.thru(qu)}function op(){return Al(this.__wrapped__,this.__actions__)}var sp=ui(function(e,n,t){we.call(e,t)?++e[t]:Kn(e,t,1)});function fp(e,n,t){var r=H(e)?Na:ec;return t&&an(e,n,t)&&(n=l),r(e,Y(n,3))}function cp(e,n){var t=H(e)?ut:fl;return t(e,Y(n,3))}var dp=Ul(uo),pp=Ul(ao);function vp(e,n){return Xe(vi(e,n),1)}function hp(e,n){return Xe(vi(e,n),Q)}function gp(e,n,t){return t=t===l?1:Z(t),Xe(vi(e,n),t)}function po(e,n){var t=H(e)?yn:st;return t(e,Y(n,3))}function vo(e,n){var t=H(e)?Ms:sl;return t(e,Y(n,3))}var mp=ui(function(e,n,t){we.call(e,t)?e[t].push(n):Kn(e,t,[n])});function _p(e,n,t,r){e=sn(e)?e:jt(e),t=t&&!r?Z(t):0;var i=e.length;return t<0&&(t=He(i+t,0)),wi(e)?t<=i&&e.indexOf(n,t)>-1:!!i&&Yt(e,n,t)>-1}var wp=ee(function(e,n,t){var r=-1,i=typeof n=="function",a=sn(e)?v(e.length):[];return st(e,function(o){a[++r]=i?pn(n,o,t):hr(o,n,t)}),a}),yp=ui(function(e,n,t){Kn(e,t,n)});function vi(e,n){var t=H(e)?Re:gl;return t(e,Y(n,3))}function Dp(e,n,t,r){return e==null?[]:(H(n)||(n=n==null?[]:[n]),t=r?l:t,H(t)||(t=t==null?[]:[t]),yl(e,n,t))}var bp=ui(function(e,n,t){e[t?0:1].push(n)},function(){return[[],[]]});function Pp(e,n,t){var r=H(e)?Xi:$a,i=arguments.length<3;return r(e,Y(n,4),t,i,st)}function xp(e,n,t){var r=H(e)?Os:$a,i=arguments.length<3;return r(e,Y(n,4),t,i,sl)}function Sp(e,n){var t=H(e)?ut:fl;return t(e,mi(Y(n,3)))}function Rp(e){var n=H(e)?ul:_c;return n(e)}function Ap(e,n,t){(t?an(e,n,t):n===l)?n=1:n=Z(n);var r=H(e)?Kf:wc;return r(e,n)}function Tp(e){var n=H(e)?Zf:Dc;return n(e)}function Ep(e){if(e==null)return 0;if(sn(e))return wi(e)?Wt(e):e.length;var n=nn(e);return n==Ne||n==dn?e.size:mu(e).length}function Cp(e,n,t){var r=H(e)?ji:bc;return t&&an(e,n,t)&&(n=l),r(e,Y(n,3))}var kp=ee(function(e,n){if(e==null)return[];var t=n.length;return t>1&&an(e,n[0],n[1])?n=[]:t>2&&an(n[0],n[1],n[2])&&(n=[n[0]]),yl(e,Xe(n,1),[])}),hi=cf||function(){return Je.Date.now()};function Ip(e,n){if(typeof n!="function")throw new Dn(U);return e=Z(e),function(){if(--e<1)return n.apply(this,arguments)}}function ho(e,n,t){return n=t?l:n,n=e&&n==null?e.length:n,Zn(e,Oe,l,l,l,l,n)}function go(e,n){var t;if(typeof n!="function")throw new Dn(U);return e=Z(e),function(){return--e>0&&(t=n.apply(this,arguments)),e<=1&&(n=l),t}}var Yu=ee(function(e,n,t){var r=fe;if(t.length){var i=lt(t,Jt(Yu));r|=Be}return Zn(e,r,n,t,i)}),mo=ee(function(e,n,t){var r=fe|K;if(t.length){var i=lt(t,Jt(mo));r|=Be}return Zn(n,r,e,t,i)});function _o(e,n,t){n=t?l:n;var r=Zn(e,ae,l,l,l,l,l,n);return r.placeholder=_o.placeholder,r}function wo(e,n,t){n=t?l:n;var r=Zn(e,Pe,l,l,l,l,l,n);return r.placeholder=wo.placeholder,r}function yo(e,n,t){var r,i,a,o,s,c,_=0,w=!1,b=!1,T=!0;if(typeof e!="function")throw new Dn(U);n=Rn(n)||0,Ce(t)&&(w=!!t.leading,b="maxWait"in t,a=b?He(Rn(t.maxWait)||0,n):a,T="trailing"in t?!!t.trailing:T);function L(Ve){var Fn=r,nt=i;return r=i=l,_=Ve,o=e.apply(nt,Fn),o}function B(Ve){return _=Ve,s=yr(te,n),w?L(Ve):o}function X(Ve){var Fn=Ve-c,nt=Ve-_,qo=n-Fn;return b?en(qo,a-nt):qo}function W(Ve){var Fn=Ve-c,nt=Ve-_;return c===l||Fn>=n||Fn<0||b&&nt>=a}function te(){var Ve=hi();if(W(Ve))return oe(Ve);s=yr(te,X(Ve))}function oe(Ve){return s=l,T&&r?L(Ve):(r=i=l,o)}function mn(){s!==l&&El(s),_=0,r=c=i=s=l}function ln(){return s===l?o:oe(hi())}function _n(){var Ve=hi(),Fn=W(Ve);if(r=arguments,i=this,c=Ve,Fn){if(s===l)return B(c);if(b)return El(s),s=yr(te,n),L(c)}return s===l&&(s=yr(te,n)),o}return _n.cancel=mn,_n.flush=ln,_n}var Lp=ee(function(e,n){return ol(e,1,n)}),Mp=ee(function(e,n,t){return ol(e,Rn(n)||0,t)});function Op(e){return Zn(e,We)}function gi(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new Dn(U);var t=function(){var r=arguments,i=n?n.apply(this,r):r[0],a=t.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return t.cache=a.set(i,o)||a,o};return t.cache=new(gi.Cache||Qn),t}gi.Cache=Qn;function mi(e){if(typeof e!="function")throw new Dn(U);return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}function Fp(e){return go(2,e)}var Vp=Pc(function(e,n){n=n.length==1&&H(n[0])?Re(n[0],vn(Y())):Re(Xe(n,1),vn(Y()));var t=n.length;return ee(function(r){for(var i=-1,a=en(r.length,t);++i<a;)r[i]=n[i].call(this,r[i]);return pn(e,this,r)})}),Bu=ee(function(e,n){var t=lt(n,Jt(Bu));return Zn(e,Be,l,n,t)}),Do=ee(function(e,n){var t=lt(n,Jt(Do));return Zn(e,qe,l,n,t)}),Up=Jn(function(e,n){return Zn(e,rn,l,l,l,n)});function qp(e,n){if(typeof e!="function")throw new Dn(U);return n=n===l?n:Z(n),ee(e,n)}function Np(e,n){if(typeof e!="function")throw new Dn(U);return n=n==null?0:He(Z(n),0),ee(function(t){var r=t[n],i=dt(t,0,n);return r&&at(i,r),pn(e,this,i)})}function Yp(e,n,t){var r=!0,i=!0;if(typeof e!="function")throw new Dn(U);return Ce(t)&&(r="leading"in t?!!t.leading:r,i="trailing"in t?!!t.trailing:i),yo(e,n,{leading:r,maxWait:n,trailing:i})}function Bp(e){return ho(e,1)}function Wp(e,n){return Bu(Ru(n),e)}function $p(){if(!arguments.length)return[];var e=arguments[0];return H(e)?e:[e]}function zp(e){return Pn(e,D)}function Hp(e,n){return n=typeof n=="function"?n:l,Pn(e,D,n)}function Gp(e){return Pn(e,ve|D)}function Qp(e,n){return n=typeof n=="function"?n:l,Pn(e,ve|D,n)}function Kp(e,n){return n==null||ll(e,n,Ge(n))}function On(e,n){return e===n||e!==e&&n!==n}var Zp=si(vu),Jp=si(function(e,n){return e>=n}),At=pl(function(){return arguments}())?pl:function(e){return Ie(e)&&we.call(e,"callee")&&!ja.call(e,"callee")},H=v.isArray,Xp=Ma?vn(Ma):ac;function sn(e){return e!=null&&_i(e.length)&&!jn(e)}function Fe(e){return Ie(e)&&sn(e)}function jp(e){return e===!0||e===!1||Ie(e)&&un(e)==zn}var pt=pf||ju,ev=Oa?vn(Oa):lc;function nv(e){return Ie(e)&&e.nodeType===1&&!Dr(e)}function tv(e){if(e==null)return!0;if(sn(e)&&(H(e)||typeof e=="string"||typeof e.splice=="function"||pt(e)||Xt(e)||At(e)))return!e.length;var n=nn(e);if(n==Ne||n==dn)return!e.size;if(wr(e))return!mu(e).length;for(var t in e)if(we.call(e,t))return!1;return!0}function rv(e,n){return gr(e,n)}function iv(e,n,t){t=typeof t=="function"?t:l;var r=t?t(e,n):l;return r===l?gr(e,n,l,t):!!r}function Wu(e){if(!Ie(e))return!1;var n=un(e);return n==Lt||n==It||typeof e.message=="string"&&typeof e.name=="string"&&!Dr(e)}function uv(e){return typeof e=="number"&&nl(e)}function jn(e){if(!Ce(e))return!1;var n=un(e);return n==Te||n==je||n==kt||n==Ar}function bo(e){return typeof e=="number"&&e==Z(e)}function _i(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function Ce(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function Ie(e){return e!=null&&typeof e=="object"}var Po=Fa?vn(Fa):sc;function av(e,n){return e===n||gu(e,n,Lu(n))}function lv(e,n,t){return t=typeof t=="function"?t:l,gu(e,n,Lu(n),t)}function ov(e){return xo(e)&&e!=+e}function sv(e){if(Hc(e))throw new z($);return vl(e)}function fv(e){return e===null}function cv(e){return e==null}function xo(e){return typeof e=="number"||Ie(e)&&un(e)==Cn}function Dr(e){if(!Ie(e)||un(e)!=kn)return!1;var n=zr(e);if(n===null)return!0;var t=we.call(n,"constructor")&&n.constructor;return typeof t=="function"&&t instanceof t&&Yr.call(t)==lf}var $u=Va?vn(Va):fc;function dv(e){return bo(e)&&e>=-J&&e<=J}var So=Ua?vn(Ua):cc;function wi(e){return typeof e=="string"||!H(e)&&Ie(e)&&un(e)==gt}function gn(e){return typeof e=="symbol"||Ie(e)&&un(e)==Ft}var Xt=qa?vn(qa):dc;function pv(e){return e===l}function vv(e){return Ie(e)&&nn(e)==mt}function hv(e){return Ie(e)&&un(e)==Ai}var gv=si(_u),mv=si(function(e,n){return e<=n});function Ro(e){if(!e)return[];if(sn(e))return wi(e)?Ln(e):on(e);if(or&&e[or])return Qs(e[or]());var n=nn(e),t=n==Ne?uu:n==dn?Ur:jt;return t(e)}function et(e){if(!e)return e===0?e:0;if(e=Rn(e),e===Q||e===-Q){var n=e<0?-1:1;return n*vt}return e===e?e:0}function Z(e){var n=et(e),t=n%1;return n===n?t?n-t:n:0}function Ao(e){return e?Pt(Z(e),0,ce):0}function Rn(e){if(typeof e=="number")return e;if(gn(e))return tt;if(Ce(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=Ce(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=za(e);var t=Wi.test(e);return t||h.test(e)?ks(e.slice(2),t?2:8):Bi.test(e)?tt:+e}function To(e){return Yn(e,fn(e))}function _v(e){return e?Pt(Z(e),-J,J):e===0?e:0}function me(e){return e==null?"":hn(e)}var wv=Kt(function(e,n){if(wr(n)||sn(n)){Yn(n,Ge(n),e);return}for(var t in n)we.call(n,t)&&pr(e,t,n[t])}),Eo=Kt(function(e,n){Yn(n,fn(n),e)}),yi=Kt(function(e,n,t,r){Yn(n,fn(n),e,r)}),yv=Kt(function(e,n,t,r){Yn(n,Ge(n),e,r)}),Dv=Jn(cu);function bv(e,n){var t=Qt(e);return n==null?t:al(t,n)}var Pv=ee(function(e,n){e=ye(e);var t=-1,r=n.length,i=r>2?n[2]:l;for(i&&an(n[0],n[1],i)&&(r=1);++t<r;)for(var a=n[t],o=fn(a),s=-1,c=o.length;++s<c;){var _=o[s],w=e[_];(w===l||On(w,zt[_])&&!we.call(e,_))&&(e[_]=a[_])}return e}),xv=ee(function(e){return e.push(l,zl),pn(Co,l,e)});function Sv(e,n){return Ya(e,Y(n,3),Nn)}function Rv(e,n){return Ya(e,Y(n,3),pu)}function Av(e,n){return e==null?e:du(e,Y(n,3),fn)}function Tv(e,n){return e==null?e:cl(e,Y(n,3),fn)}function Ev(e,n){return e&&Nn(e,Y(n,3))}function Cv(e,n){return e&&pu(e,Y(n,3))}function kv(e){return e==null?[]:ni(e,Ge(e))}function Iv(e){return e==null?[]:ni(e,fn(e))}function zu(e,n,t){var r=e==null?l:xt(e,n);return r===l?t:r}function Lv(e,n){return e!=null&&Ql(e,n,tc)}function Hu(e,n){return e!=null&&Ql(e,n,rc)}var Mv=Nl(function(e,n,t){n!=null&&typeof n.toString!="function"&&(n=Br.call(n)),e[n]=t},Qu(cn)),Ov=Nl(function(e,n,t){n!=null&&typeof n.toString!="function"&&(n=Br.call(n)),we.call(e,n)?e[n].push(t):e[n]=[t]},Y),Fv=ee(hr);function Ge(e){return sn(e)?il(e):mu(e)}function fn(e){return sn(e)?il(e,!0):pc(e)}function Vv(e,n){var t={};return n=Y(n,3),Nn(e,function(r,i,a){Kn(t,n(r,i,a),r)}),t}function Uv(e,n){var t={};return n=Y(n,3),Nn(e,function(r,i,a){Kn(t,i,n(r,i,a))}),t}var qv=Kt(function(e,n,t){ti(e,n,t)}),Co=Kt(function(e,n,t,r){ti(e,n,t,r)}),Nv=Jn(function(e,n){var t={};if(e==null)return t;var r=!1;n=Re(n,function(a){return a=ct(a,e),r||(r=a.length>1),a}),Yn(e,ku(e),t),r&&(t=Pn(t,ve|N|D,Mc));for(var i=n.length;i--;)Pu(t,n[i]);return t});function Yv(e,n){return ko(e,mi(Y(n)))}var Bv=Jn(function(e,n){return e==null?{}:hc(e,n)});function ko(e,n){if(e==null)return{};var t=Re(ku(e),function(r){return[r]});return n=Y(n),Dl(e,t,function(r,i){return n(r,i[0])})}function Wv(e,n,t){n=ct(n,e);var r=-1,i=n.length;for(i||(i=1,e=l);++r<i;){var a=e==null?l:e[Bn(n[r])];a===l&&(r=i,a=t),e=jn(a)?a.call(e):a}return e}function $v(e,n,t){return e==null?e:mr(e,n,t)}function zv(e,n,t,r){return r=typeof r=="function"?r:l,e==null?e:mr(e,n,t,r)}var Io=Wl(Ge),Lo=Wl(fn);function Hv(e,n,t){var r=H(e),i=r||pt(e)||Xt(e);if(n=Y(n,4),t==null){var a=e&&e.constructor;i?t=r?new a:[]:Ce(e)?t=jn(a)?Qt(zr(e)):{}:t={}}return(i?yn:Nn)(e,function(o,s,c){return n(t,o,s,c)}),t}function Gv(e,n){return e==null?!0:Pu(e,n)}function Qv(e,n,t){return e==null?e:Rl(e,n,Ru(t))}function Kv(e,n,t,r){return r=typeof r=="function"?r:l,e==null?e:Rl(e,n,Ru(t),r)}function jt(e){return e==null?[]:iu(e,Ge(e))}function Zv(e){return e==null?[]:iu(e,fn(e))}function Jv(e,n,t){return t===l&&(t=n,n=l),t!==l&&(t=Rn(t),t=t===t?t:0),n!==l&&(n=Rn(n),n=n===n?n:0),Pt(Rn(e),n,t)}function Xv(e,n,t){return n=et(n),t===l?(t=n,n=0):t=et(t),e=Rn(e),ic(e,n,t)}function jv(e,n,t){if(t&&typeof t!="boolean"&&an(e,n,t)&&(n=t=l),t===l&&(typeof n=="boolean"?(t=n,n=l):typeof e=="boolean"&&(t=e,e=l)),e===l&&n===l?(e=0,n=1):(e=et(e),n===l?(n=e,e=0):n=et(n)),e>n){var r=e;e=n,n=r}if(t||e%1||n%1){var i=tl();return en(e+i*(n-e+Cs("1e-"+((i+"").length-1))),n)}return yu(e,n)}var eh=Zt(function(e,n,t){return n=n.toLowerCase(),e+(t?Mo(n):n)});function Mo(e){return Gu(me(e).toLowerCase())}function Oo(e){return e=me(e),e&&e.replace(F,Ws).replace(ys,"")}function nh(e,n,t){e=me(e),n=hn(n);var r=e.length;t=t===l?r:Pt(Z(t),0,r);var i=t;return t-=n.length,t>=0&&e.slice(t,i)==n}function th(e){return e=me(e),e&&kr.test(e)?e.replace(Er,$s):e}function rh(e){return e=me(e),e&&Oi.test(e)?e.replace(ar,"\\$&"):e}var ih=Zt(function(e,n,t){return e+(t?"-":"")+n.toLowerCase()}),uh=Zt(function(e,n,t){return e+(t?" ":"")+n.toLowerCase()}),ah=Vl("toLowerCase");function lh(e,n,t){e=me(e),n=Z(n);var r=n?Wt(e):0;if(!n||r>=n)return e;var i=(n-r)/2;return oi(Kr(i),t)+e+oi(Qr(i),t)}function oh(e,n,t){e=me(e),n=Z(n);var r=n?Wt(e):0;return n&&r<n?e+oi(n-r,t):e}function sh(e,n,t){e=me(e),n=Z(n);var r=n?Wt(e):0;return n&&r<n?oi(n-r,t)+e:e}function fh(e,n,t){return t||n==null?n=0:n&&(n=+n),mf(me(e).replace(qt,""),n||0)}function ch(e,n,t){return(t?an(e,n,t):n===l)?n=1:n=Z(n),Du(me(e),n)}function dh(){var e=arguments,n=me(e[0]);return e.length<3?n:n.replace(e[1],e[2])}var ph=Zt(function(e,n,t){return e+(t?"_":"")+n.toLowerCase()});function vh(e,n,t){return t&&typeof t!="number"&&an(e,n,t)&&(n=t=l),t=t===l?ce:t>>>0,t?(e=me(e),e&&(typeof n=="string"||n!=null&&!$u(n))&&(n=hn(n),!n&&Bt(e))?dt(Ln(e),0,t):e.split(n,t)):[]}var hh=Zt(function(e,n,t){return e+(t?" ":"")+Gu(n)});function gh(e,n,t){return e=me(e),t=t==null?0:Pt(Z(t),0,e.length),n=hn(n),e.slice(t,t+n.length)==n}function mh(e,n,t){var r=u.templateSettings;t&&an(e,n,t)&&(n=l),e=me(e),n=yi({},n,r,$l);var i=yi({},n.imports,r.imports,$l),a=Ge(i),o=iu(i,a),s,c,_=0,w=n.interpolate||R,b="__p += '",T=au((n.escape||R).source+"|"+w.source+"|"+(w===Ir?Yi:R).source+"|"+(n.evaluate||R).source+"|$","g"),L="//# sourceURL="+(we.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ss+"]")+`
`;e.replace(T,function(W,te,oe,mn,ln,_n){return oe||(oe=mn),b+=e.slice(_,_n).replace(Ze,zs),te&&(s=!0,b+=`' +
__e(`+te+`) +
'`),ln&&(c=!0,b+=`';
`+ln+`;
__p += '`),oe&&(b+=`' +
((__t = (`+oe+`)) == null ? '' : __t) +
'`),_=_n+W.length,W}),b+=`';
`;var B=we.call(n,"variable")&&n.variable;if(!B)b=`with (obj) {
`+b+`
}
`;else if(qi.test(B))throw new z(x);b=(c?b.replace(Ti,""):b).replace(Ei,"$1").replace(Ci,"$1;"),b="function("+(B||"obj")+`) {
`+(B?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(s?", __e = _.escape":"")+(c?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+b+`return __p
}`;var X=Vo(function(){return he(a,L+"return "+b).apply(l,o)});if(X.source=b,Wu(X))throw X;return X}function _h(e){return me(e).toLowerCase()}function wh(e){return me(e).toUpperCase()}function yh(e,n,t){if(e=me(e),e&&(t||n===l))return za(e);if(!e||!(n=hn(n)))return e;var r=Ln(e),i=Ln(n),a=Ha(r,i),o=Ga(r,i)+1;return dt(r,a,o).join("")}function Dh(e,n,t){if(e=me(e),e&&(t||n===l))return e.slice(0,Ka(e)+1);if(!e||!(n=hn(n)))return e;var r=Ln(e),i=Ga(r,Ln(n))+1;return dt(r,0,i).join("")}function bh(e,n,t){if(e=me(e),e&&(t||n===l))return e.replace(qt,"");if(!e||!(n=hn(n)))return e;var r=Ln(e),i=Ha(r,Ln(n));return dt(r,i).join("")}function Ph(e,n){var t=ke,r=re;if(Ce(n)){var i="separator"in n?n.separator:i;t="length"in n?Z(n.length):t,r="omission"in n?hn(n.omission):r}e=me(e);var a=e.length;if(Bt(e)){var o=Ln(e);a=o.length}if(t>=a)return e;var s=t-Wt(r);if(s<1)return r;var c=o?dt(o,0,s).join(""):e.slice(0,s);if(i===l)return c+r;if(o&&(s+=c.length-s),$u(i)){if(e.slice(s).search(i)){var _,w=c;for(i.global||(i=au(i.source,me(Mr.exec(i))+"g")),i.lastIndex=0;_=i.exec(w);)var b=_.index;c=c.slice(0,b===l?s:b)}}else if(e.indexOf(hn(i),s)!=s){var T=c.lastIndexOf(i);T>-1&&(c=c.slice(0,T))}return c+r}function xh(e){return e=me(e),e&&Cr.test(e)?e.replace(Tr,Xs):e}var Sh=Zt(function(e,n,t){return e+(t?" ":"")+n.toUpperCase()}),Gu=Vl("toUpperCase");function Fo(e,n,t){return e=me(e),n=t?l:n,n===l?Gs(e)?nf(e):Us(e):e.match(n)||[]}var Vo=ee(function(e,n){try{return pn(e,l,n)}catch(t){return Wu(t)?t:new z(t)}}),Rh=Jn(function(e,n){return yn(n,function(t){t=Bn(t),Kn(e,t,Yu(e[t],e))}),e});function Ah(e){var n=e==null?0:e.length,t=Y();return e=n?Re(e,function(r){if(typeof r[1]!="function")throw new Dn(U);return[t(r[0]),r[1]]}):[],ee(function(r){for(var i=-1;++i<n;){var a=e[i];if(pn(a[0],this,r))return pn(a[1],this,r)}})}function Th(e){return jf(Pn(e,ve))}function Qu(e){return function(){return e}}function Eh(e,n){return e==null||e!==e?n:e}var Ch=ql(),kh=ql(!0);function cn(e){return e}function Ku(e){return hl(typeof e=="function"?e:Pn(e,ve))}function Ih(e){return ml(Pn(e,ve))}function Lh(e,n){return _l(e,Pn(n,ve))}var Mh=ee(function(e,n){return function(t){return hr(t,e,n)}}),Oh=ee(function(e,n){return function(t){return hr(e,t,n)}});function Zu(e,n,t){var r=Ge(n),i=ni(n,r);t==null&&!(Ce(n)&&(i.length||!r.length))&&(t=n,n=e,e=this,i=ni(n,Ge(n)));var a=!(Ce(t)&&"chain"in t)||!!t.chain,o=jn(e);return yn(i,function(s){var c=n[s];e[s]=c,o&&(e.prototype[s]=function(){var _=this.__chain__;if(a||_){var w=e(this.__wrapped__),b=w.__actions__=on(this.__actions__);return b.push({func:c,args:arguments,thisArg:e}),w.__chain__=_,w}return c.apply(e,at([this.value()],arguments))})}),e}function Fh(){return Je._===this&&(Je._=of),this}function Ju(){}function Vh(e){return e=Z(e),ee(function(n){return wl(n,e)})}var Uh=Tu(Re),qh=Tu(Na),Nh=Tu(ji);function Uo(e){return Ou(e)?eu(Bn(e)):gc(e)}function Yh(e){return function(n){return e==null?l:xt(e,n)}}var Bh=Yl(),Wh=Yl(!0);function Xu(){return[]}function ju(){return!1}function $h(){return{}}function zh(){return""}function Hh(){return!0}function Gh(e,n){if(e=Z(e),e<1||e>J)return[];var t=ce,r=en(e,ce);n=Y(n),e-=ce;for(var i=ru(r,n);++t<e;)n(t);return i}function Qh(e){return H(e)?Re(e,Bn):gn(e)?[e]:on(ro(me(e)))}function Kh(e){var n=++af;return me(e)+n}var Zh=li(function(e,n){return e+n},0),Jh=Eu("ceil"),Xh=li(function(e,n){return e/n},1),jh=Eu("floor");function eg(e){return e&&e.length?ei(e,cn,vu):l}function ng(e,n){return e&&e.length?ei(e,Y(n,2),vu):l}function tg(e){return Wa(e,cn)}function rg(e,n){return Wa(e,Y(n,2))}function ig(e){return e&&e.length?ei(e,cn,_u):l}function ug(e,n){return e&&e.length?ei(e,Y(n,2),_u):l}var ag=li(function(e,n){return e*n},1),lg=Eu("round"),og=li(function(e,n){return e-n},0);function sg(e){return e&&e.length?tu(e,cn):0}function fg(e,n){return e&&e.length?tu(e,Y(n,2)):0}return u.after=Ip,u.ary=ho,u.assign=wv,u.assignIn=Eo,u.assignInWith=yi,u.assignWith=yv,u.at=Dv,u.before=go,u.bind=Yu,u.bindAll=Rh,u.bindKey=mo,u.castArray=$p,u.chain=co,u.chunk=jc,u.compact=ed,u.concat=nd,u.cond=Ah,u.conforms=Th,u.constant=Qu,u.countBy=sp,u.create=bv,u.curry=_o,u.curryRight=wo,u.debounce=yo,u.defaults=Pv,u.defaultsDeep=xv,u.defer=Lp,u.delay=Mp,u.difference=td,u.differenceBy=rd,u.differenceWith=id,u.drop=ud,u.dropRight=ad,u.dropRightWhile=ld,u.dropWhile=od,u.fill=sd,u.filter=cp,u.flatMap=vp,u.flatMapDeep=hp,u.flatMapDepth=gp,u.flatten=lo,u.flattenDeep=fd,u.flattenDepth=cd,u.flip=Op,u.flow=Ch,u.flowRight=kh,u.fromPairs=dd,u.functions=kv,u.functionsIn=Iv,u.groupBy=mp,u.initial=vd,u.intersection=hd,u.intersectionBy=gd,u.intersectionWith=md,u.invert=Mv,u.invertBy=Ov,u.invokeMap=wp,u.iteratee=Ku,u.keyBy=yp,u.keys=Ge,u.keysIn=fn,u.map=vi,u.mapKeys=Vv,u.mapValues=Uv,u.matches=Ih,u.matchesProperty=Lh,u.memoize=gi,u.merge=qv,u.mergeWith=Co,u.method=Mh,u.methodOf=Oh,u.mixin=Zu,u.negate=mi,u.nthArg=Vh,u.omit=Nv,u.omitBy=Yv,u.once=Fp,u.orderBy=Dp,u.over=Uh,u.overArgs=Vp,u.overEvery=qh,u.overSome=Nh,u.partial=Bu,u.partialRight=Do,u.partition=bp,u.pick=Bv,u.pickBy=ko,u.property=Uo,u.propertyOf=Yh,u.pull=Dd,u.pullAll=so,u.pullAllBy=bd,u.pullAllWith=Pd,u.pullAt=xd,u.range=Bh,u.rangeRight=Wh,u.rearg=Up,u.reject=Sp,u.remove=Sd,u.rest=qp,u.reverse=qu,u.sampleSize=Ap,u.set=$v,u.setWith=zv,u.shuffle=Tp,u.slice=Rd,u.sortBy=kp,u.sortedUniq=Ld,u.sortedUniqBy=Md,u.split=vh,u.spread=Np,u.tail=Od,u.take=Fd,u.takeRight=Vd,u.takeRightWhile=Ud,u.takeWhile=qd,u.tap=ep,u.throttle=Yp,u.thru=pi,u.toArray=Ro,u.toPairs=Io,u.toPairsIn=Lo,u.toPath=Qh,u.toPlainObject=To,u.transform=Hv,u.unary=Bp,u.union=Nd,u.unionBy=Yd,u.unionWith=Bd,u.uniq=Wd,u.uniqBy=$d,u.uniqWith=zd,u.unset=Gv,u.unzip=Nu,u.unzipWith=fo,u.update=Qv,u.updateWith=Kv,u.values=jt,u.valuesIn=Zv,u.without=Hd,u.words=Fo,u.wrap=Wp,u.xor=Gd,u.xorBy=Qd,u.xorWith=Kd,u.zip=Zd,u.zipObject=Jd,u.zipObjectDeep=Xd,u.zipWith=jd,u.entries=Io,u.entriesIn=Lo,u.extend=Eo,u.extendWith=yi,Zu(u,u),u.add=Zh,u.attempt=Vo,u.camelCase=eh,u.capitalize=Mo,u.ceil=Jh,u.clamp=Jv,u.clone=zp,u.cloneDeep=Gp,u.cloneDeepWith=Qp,u.cloneWith=Hp,u.conformsTo=Kp,u.deburr=Oo,u.defaultTo=Eh,u.divide=Xh,u.endsWith=nh,u.eq=On,u.escape=th,u.escapeRegExp=rh,u.every=fp,u.find=dp,u.findIndex=uo,u.findKey=Sv,u.findLast=pp,u.findLastIndex=ao,u.findLastKey=Rv,u.floor=jh,u.forEach=po,u.forEachRight=vo,u.forIn=Av,u.forInRight=Tv,u.forOwn=Ev,u.forOwnRight=Cv,u.get=zu,u.gt=Zp,u.gte=Jp,u.has=Lv,u.hasIn=Hu,u.head=oo,u.identity=cn,u.includes=_p,u.indexOf=pd,u.inRange=Xv,u.invoke=Fv,u.isArguments=At,u.isArray=H,u.isArrayBuffer=Xp,u.isArrayLike=sn,u.isArrayLikeObject=Fe,u.isBoolean=jp,u.isBuffer=pt,u.isDate=ev,u.isElement=nv,u.isEmpty=tv,u.isEqual=rv,u.isEqualWith=iv,u.isError=Wu,u.isFinite=uv,u.isFunction=jn,u.isInteger=bo,u.isLength=_i,u.isMap=Po,u.isMatch=av,u.isMatchWith=lv,u.isNaN=ov,u.isNative=sv,u.isNil=cv,u.isNull=fv,u.isNumber=xo,u.isObject=Ce,u.isObjectLike=Ie,u.isPlainObject=Dr,u.isRegExp=$u,u.isSafeInteger=dv,u.isSet=So,u.isString=wi,u.isSymbol=gn,u.isTypedArray=Xt,u.isUndefined=pv,u.isWeakMap=vv,u.isWeakSet=hv,u.join=_d,u.kebabCase=ih,u.last=Sn,u.lastIndexOf=wd,u.lowerCase=uh,u.lowerFirst=ah,u.lt=gv,u.lte=mv,u.max=eg,u.maxBy=ng,u.mean=tg,u.meanBy=rg,u.min=ig,u.minBy=ug,u.stubArray=Xu,u.stubFalse=ju,u.stubObject=$h,u.stubString=zh,u.stubTrue=Hh,u.multiply=ag,u.nth=yd,u.noConflict=Fh,u.noop=Ju,u.now=hi,u.pad=lh,u.padEnd=oh,u.padStart=sh,u.parseInt=fh,u.random=jv,u.reduce=Pp,u.reduceRight=xp,u.repeat=ch,u.replace=dh,u.result=Wv,u.round=lg,u.runInContext=f,u.sample=Rp,u.size=Ep,u.snakeCase=ph,u.some=Cp,u.sortedIndex=Ad,u.sortedIndexBy=Td,u.sortedIndexOf=Ed,u.sortedLastIndex=Cd,u.sortedLastIndexBy=kd,u.sortedLastIndexOf=Id,u.startCase=hh,u.startsWith=gh,u.subtract=og,u.sum=sg,u.sumBy=fg,u.template=mh,u.times=Gh,u.toFinite=et,u.toInteger=Z,u.toLength=Ao,u.toLower=_h,u.toNumber=Rn,u.toSafeInteger=_v,u.toString=me,u.toUpper=wh,u.trim=yh,u.trimEnd=Dh,u.trimStart=bh,u.truncate=Ph,u.unescape=xh,u.uniqueId=Kh,u.upperCase=Sh,u.upperFirst=Gu,u.each=po,u.eachRight=vo,u.first=oo,Zu(u,function(){var e={};return Nn(u,function(n,t){we.call(u.prototype,t)||(e[t]=n)}),e}(),{chain:!1}),u.VERSION=S,yn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),yn(["drop","take"],function(e,n){ie.prototype[e]=function(t){t=t===l?1:He(Z(t),0);var r=this.__filtered__&&!n?new ie(this):this.clone();return r.__filtered__?r.__takeCount__=en(t,r.__takeCount__):r.__views__.push({size:en(t,ce),type:e+(r.__dir__<0?"Right":"")}),r},ie.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),yn(["filter","map","takeWhile"],function(e,n){var t=n+1,r=t==m||t==le;ie.prototype[e]=function(i){var a=this.clone();return a.__iteratees__.push({iteratee:Y(i,3),type:t}),a.__filtered__=a.__filtered__||r,a}}),yn(["head","last"],function(e,n){var t="take"+(n?"Right":"");ie.prototype[e]=function(){return this[t](1).value()[0]}}),yn(["initial","tail"],function(e,n){var t="drop"+(n?"":"Right");ie.prototype[e]=function(){return this.__filtered__?new ie(this):this[t](1)}}),ie.prototype.compact=function(){return this.filter(cn)},ie.prototype.find=function(e){return this.filter(e).head()},ie.prototype.findLast=function(e){return this.reverse().find(e)},ie.prototype.invokeMap=ee(function(e,n){return typeof e=="function"?new ie(this):this.map(function(t){return hr(t,e,n)})}),ie.prototype.reject=function(e){return this.filter(mi(Y(e)))},ie.prototype.slice=function(e,n){e=Z(e);var t=this;return t.__filtered__&&(e>0||n<0)?new ie(t):(e<0?t=t.takeRight(-e):e&&(t=t.drop(e)),n!==l&&(n=Z(n),t=n<0?t.dropRight(-n):t.take(n-e)),t)},ie.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ie.prototype.toArray=function(){return this.take(ce)},Nn(ie.prototype,function(e,n){var t=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),i=u[r?"take"+(n=="last"?"Right":""):n],a=r||/^find/.test(n);!i||(u.prototype[n]=function(){var o=this.__wrapped__,s=r?[1]:arguments,c=o instanceof ie,_=s[0],w=c||H(o),b=function(te){var oe=i.apply(u,at([te],s));return r&&T?oe[0]:oe};w&&t&&typeof _=="function"&&_.length!=1&&(c=w=!1);var T=this.__chain__,L=!!this.__actions__.length,B=a&&!T,X=c&&!L;if(!a&&w){o=X?o:new ie(this);var W=e.apply(o,s);return W.__actions__.push({func:pi,args:[b],thisArg:l}),new bn(W,T)}return B&&X?e.apply(this,s):(W=this.thru(b),B?r?W.value()[0]:W.value():W)})}),yn(["pop","push","shift","sort","splice","unshift"],function(e){var n=qr[e],t=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var i=arguments;if(r&&!this.__chain__){var a=this.value();return n.apply(H(a)?a:[],i)}return this[t](function(o){return n.apply(H(o)?o:[],i)})}}),Nn(ie.prototype,function(e,n){var t=u[n];if(t){var r=t.name+"";we.call(Gt,r)||(Gt[r]=[]),Gt[r].push({name:n,func:t})}}),Gt[ai(l,K).name]=[{name:"wrapper",func:l}],ie.prototype.clone=xf,ie.prototype.reverse=Sf,ie.prototype.value=Rf,u.prototype.at=np,u.prototype.chain=tp,u.prototype.commit=rp,u.prototype.next=ip,u.prototype.plant=ap,u.prototype.reverse=lp,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=op,u.prototype.first=u.prototype.head,or&&(u.prototype[or]=up),u},$t=tf();wt?((wt.exports=$t)._=$t,Ki._=$t):Je._=$t}).call(Pr)})(Ho,Ho.exports);const rm={class:"col prescription-box q-pa-md q-mb-md"},im={key:0},um={key:1},am={key:0},lm={key:1},om={class:"row"},sm=se("strong",null,[se("em",null," Medicamento sem stock ou por expirar brevemente ")],-1),fm={class:"row reverse q-mb-sm q-mt-sm q-gutter-sm"},cm={__name:"ServiceDrugsManagement",setup(C){const{isOnline:de,isMobile:l,website:S}=Ko(),{getQtyPrescribed:P}=xi(),{alertError:$}=pa(),{remainigDurationInWeeks:U}=ns(),{getQtyRemain:x}=xi(),{getDrugFirstLevelById:ne}=es(),Se=[{name:"drug",align:"left",field:"row.drug.name",label:"Medicamento",sortable:!0},{name:"dosage",align:"left",field:"row.amtPerTime",label:"Toma",sortable:!1},{name:"packs",align:"center",style:"width: 20px",field:"row.quantitySupplied",label:"Quantidade",sortable:!1},{name:"quantityRemain",align:"center",field:"quantityRemain",label:"Sobra",sortable:!1},{name:"nextPickUpDate",align:"left",field:"row.toContinue",label:"Pr\xF3x. Levantamento",sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1}],G=V(!1),ve=Zo(V(!1)),N=V(0),D=V(""),I=_e("curPrescription"),j=_e("curPatientVisitDetail"),fe=_e("curPrescriptionDetail"),K=_e("curPack"),pe=_e("validateDispense"),ae=_e("addPatientVisitDetail"),Pe=_e("removePatientVisitDetail"),Be=_e("curIdentifier"),qe=_e("submittingValidateDispense"),Oe=M=>{const y=K.value.packagedDrugs.map(m=>m.id).indexOf(M.id);K.value.packagedDrugs.splice(y,1)},rn=async M=>{const y=new aa({id:Wn()});y.amtPerTime=M.amtPerTime,y.timesPerDay=M.timesPerDay,y.form=M.form,y.drug=M.drug,y.drug_id=M.drug.id,K.value.packagedDrugs.some(q=>q.drug.id===M.drug.id)?$("O medicamento ja existe na lista dos medicamentos por dispensar."):await ke(y)?D.value.weeks>U(I.value)?$("error","O Per\xEDodo para o qual pretende efectuar a dispensa \xE9 maior que o per\xEDodo remanescente nesta prescri\xE7\xE3o ["+Number(U(I.value)/4)+" mes(es)]"):(G.value=!1,K.value.packagedDrugs.push(y)):$("O medicamento seleccionado n\xE3o possui stock suficiente para dispensar at\xE9 a data da dispensa"),ve.value=!1},We=M=>bi.getCleanDrugById(M),ke=async M=>{const y=P(M,K.value.weeksSupply);if(M.drug=We(M.drug.id),M.quantitySupplied=y,de.value){const m=await Pi.checkStockStatus(M.drug.id,K.value.pickupDate,y,la.currClinic().id,K.value.weeksSupply);return N.value=m,m}else{let m=0;const le=(await Pi.getStockByDrug(M.drug.id,la.currClinic().id)).filter(Q=>Ye(Q.expireDate)>=Ye(K.value.pickupDate));return le.length<=0?!1:(le.forEach(Q=>{m=Number(m+Q.stockMoviment)}),!(m<y))}},re=async()=>{try{K.value.packagedDrugs.map(M=>({...M,color:M.color||""}));for(let M=0;M<K.value.packagedDrugs.length;M++){const y=await ke(K.value.packagedDrugs[M]);K.value.packagedDrugs[M].color=y?"black":"red"}}catch(M){console.error("Error fetching data:",M)}};return Si(async()=>{re()}),Pg(()=>K.value.weeksSupply,async(M,y)=>{M!==y&&re()}),Le("showAddEditDrug",G),Le("addPrescribedDrug",rn),Le("submittingPrescribedDrug",ve),Le("curPatientVisitDetail",j),Le("curPrescriptionDetail",fe),(M,y)=>(ue(),Tn("div",null,[E(tm,{addVisible:!0,mainContainer:!1,bgColor:"bg-grey-6"},{default:O(()=>[tn(" Medicamentos para "+be(A(Be).service.code),1)]),_:1}),se("div",rm,[E(jo,{class:"col",dense:"",rows:A(K).packagedDrugs,columns:Se,"row-key":"id","hide-bottom":"",flat:""},{header:O(m=>[E(fa,{class:"text-center bg-green-2",props:m},{default:O(()=>[E(er,null,{default:O(()=>[tn(be(Se[0].label),1)]),_:1}),E(er,null,{default:O(()=>[tn(be(Se[1].label),1)]),_:1}),E(er,null,{default:O(()=>[tn(be(Se[2].label),1)]),_:1}),E(er,null,{default:O(()=>[tn(be(Se[3].label),1)]),_:1}),A(j).createPackLater?Me("",!0):(ue(),Ae(er,{key:0},{default:O(()=>[tn(be(Se[4].label),1)]),_:1})),A(j).createPackLater?Me("",!0):(ue(),Ae(er,{key:1},{default:O(()=>[tn(be(Se[5].label),1)]),_:1}))]),_:2},1032,["props"])]),body:O(m=>[E(fa,{"no-hover":"",props:m},{default:O(()=>[E(Vn,{props:m,style:xr({color:m.row.color}),key:"drug"},{default:O(()=>[tn(be(We(m.row.drug.id)!==null&&We(m.row.drug.id)!==void 0?We(m.row.drug.id).name.includes(String(A(ne)(m.row.drug.id).form.description).substring(0,4))?We(m.row.drug.id).name:We(m.row.drug.id).name+" - ("+We(m.row.drug.id).packSize+" "+String(A(ne)(m.row.drug.id).form.description).substring(0,4)+")":""),1)]),_:2},1032,["props","style"]),E(Vn,{props:m,style:xr({color:m.row.color}),key:"dosage"},{default:O(()=>[tn(be(We(m.row.drug.id)!==null&&We(m.row.drug.id)!==void 0?A(ne)(m.row.drug.id).form!==null&&A(ne)(m.row.drug.id).form!==void 0?A(ne)(m.row.drug.id).form.howToUse+" "+m.row.amtPerTime+"   "+A(ne)(m.row.drug.id).form.unit+" - "+m.row.timesPerDay+" vez(es) por "+m.row.form:"Tomar "+m.row.amtPerTime+"    - "+m.row.timesPerDay+" vez(es) por "+m.row.form:""),1)]),_:2},1032,["props","style"]),A(j).createPackLater?Me("",!0):(ue(),Ae(Vn,{style:xr({color:m.row.color}),props:m,"auto-width":"",key:"packs"},{default:O(()=>[tn(be(m.row.quantitySupplied)+" ",1),A(ne)(m.row.drug.id).clinicalService.code==="TARV"?(ue(),Tn("em",im," Frasco(s)")):(ue(),Tn("em",um,be(A(ne)(m.row.drug.id).form.description)+"(s)",1))]),_:2},1032,["style","props"])),E(Vn,{style:xr({color:m.row.color}),key:"quantityRemain",props:m},{default:O(()=>[A(ne)(m.row.drug.id).clinicalService.code==="TARV"?(ue(),Tn("em",am,be(Math.floor(A(x)(m.row,A(I).duration.weeks)/m.row.drug.packSize))+" Frasco(s) e "+be(A(x)(m.row,A(I).duration.weeks)+" "+A(ne)(m.row.drug.id).form.unit),1)):(ue(),Tn("em",lm,be(Math.floor(A(x)(m.row,A(I).duration.weeks)/m.row.drug.packSize))+" "+be(A(ne)(m.row.drug.id).form.description)+"(s) ",1))]),_:2},1032,["style","props"]),A(j).createPackLater?Me("",!0):(ue(),Ae(Vn,{style:xr({color:m.row.color}),key:"nextPickUpDate",props:m},{default:O(()=>[se("div",om,[E(Qo,{modelValue:m.row.toContinue,"onUpdate:modelValue":q=>m.row.toContinue=q,disable:m.row.color==="red"||A(pe),label:"Continua"},null,8,["modelValue","onUpdate:modelValue","disable"])])]),_:2},1032,["style","props"])),E(Vn,{key:"options",props:m},{default:O(()=>[E(Qe,{flat:"",disable:A(pe),round:"",color:"red",icon:"delete",onClick:q=>Oe(m.row)},null,8,["disable","onClick"]),m.row.color==="red"?(ue(),Ae(Qe,{key:0,flat:"",round:"",disable:A(pe),color:"red",icon:"info"},{default:O(()=>[E(Ng,{class:"bg-red",offset:[10,10],"transition-show":"flip-right","transition-hide":"flip-left"},{default:O(()=>[sm]),_:1})]),_:1},8,["disable"])):Me("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),se("div",fm,[A(pe)?Me("",!0):(ue(),Ae(Qe,{key:0,unelevated:"",color:"primary",disable:A(pe),loading:A(qe),label:"Validar Dispensa",class:"all-pointer-events",onClick:y[0]||(y[0]=m=>A(ae)())},null,8,["disable","loading"])),A(pe)?(ue(),Ae(Qe,{key:1,unelevated:"",color:"red",disable:!A(pe),label:"Invalidar Dispensa",class:"all-pointer-events",onClick:y[1]||(y[1]=m=>A(Pe)())},null,8,["disable"])):Me("",!0)]),E(Jo,{persistent:"",modelValue:G.value,"onUpdate:modelValue":y[2]||(y[2]=m=>G.value=m)},{default:O(()=>[E(ts)]),_:1},8,["modelValue"])]))}};const dm={class:"box-border"},pm={class:"q-ma-md"},vm={class:"row"},hm={class:"row items-center justify-end"},gm={class:"col"},mm={class:"row"},_m={class:"row"},wm=se("div",{class:"row items-center q-mb-xs"},[se("span",{class:"text-subtitle2"},"Adi\xE7\xE3o de Medicamento \xE0 Prescri\xE7\xE3o")],-1),ym=se("span",{class:"text-bold text-subtitle1 vertical-middle q-pl-md"},"Medicamentos Prescritos",-1),Dm={key:0},bm={key:1},Pm={key:0},xm={key:1},Sm=se("div",{class:"row items-center q-mb-xs"},[se("span",{class:"text-subtitle2"},"Informa\xE7\xE3o Adicional")],-1),Rm={class:"row"},Am={class:"col"},Tm={class:"row items-center"},Em={key:1,class:"cursor-pointer"},Cm={class:"row reverse q-mb-sm q-mt-sm q-gutter-sm"},km={key:0,class:""},Bm={__name:"AddEditPrescriptionUnit",props:["identifier"],setup(C){const{isMobile:de,isOnline:l}=Ko(),S=C,{isValidDate:P,getDDMMYYYFromJSDate:$,getDateFromHyphenDDMMYYYY:U,getYYYYMMDDFromJSDate:x}=da(),{lastVisitPrescription:ne}=$g(),{alertSucess:Se,alertError:G,alertInfo:ve,alertWarningAction:N,alertWarning:D}=pa(),{getQtyPrescribed:I}=xi(),{remainigDuration:j}=ns(),{getQtyRemain:fe}=xi(),{getDrugFirstLevelById:K}=es();V(!1);const pe=Zo(V(!1)),ae=V(),Pe=V(null),Be=V(null),qe=V(null),Oe=V(null),rn=V(null),We=V(null),ke=V(null),re=V(null),M=V(null);V("Click me");const y=V(new xg({id:Wn()})),m=V(new Sg({id:Wn()})),q=V(new Rg({id:Wn()})),le=V(new Ag({id:Wn()})),Q=V(!1),J=V(!1),vt=V(["Fal\xEAncia Terapeutica","Alergia","Outro"]),tt=V(["Inicio","Manuten\xE7\xE3o"]),ce=V(!1),ht=V(!1);V([]);const Et=V([]),Ct=V([]),En=V([]),$n=V([]),kt=V([]),zn=V([]),Un=V([]),It=V([]);V(!1),V({}),V(!1);const Lt=[{name:"drug",align:"left",field:d=>d.drug.name,label:"Medicamento",sortable:!0},{name:"dosage",align:"left",field:d=>d.drug.form.howToUse+" "+d.amtPerTime+" "+d.drug.form.unit+" "+d.timesPerDay+" vez(es) por "+d.form,label:"Toma",sortable:!1},{name:"packs",align:"center",style:"width: 20px",field:d=>I(d,y.value.duration.weeks)>0?I(d,y.value.duration.weeks):1,label:"Quantidade",sortable:!1},{name:"packs",align:"center",style:"width: 20px",field:d=>I(d,y.value.duration.weeks)>0?I(d,y.value.duration.weeks):1,label:"Sobra",sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1,field:"<q-btn/>"}],Te=_e("isNewPrescription"),je=_e("patient"),Ne=_e("curPatientVisit"),Cn=_e("selectedMember");let Mt=0;const kn=Ue(()=>Tg.getAllFromStorage()),Ot=Ue(()=>ea.checkWeatherAttExist(S.identifier.service.id,"THERAPEUTICAL_REGIMEN")),Ar=Ue(()=>ea.checkWeatherAttExist(S.identifier.service.id,"THERAPEUTICAL_LINE")),Hn=Ue(()=>m.value.reasonForUpdate==="Outro"),dn=Ue(()=>m.value.reasonForUpdateDesc),gt=Ue(()=>ea.checkWeatherAttExist(S.identifier.service.id,"PRESCRIPTION_CHANGE_MOTIVE")),Ft=Ue(()=>{const d=Eg.getClinicalServicePersonalizedById(S.identifier.service.id);return!d||!d.therapeuticRegimens?Cg.getAllTherapeuticalByclinicalService(S.identifier.service.id):d.therapeuticRegimens}),Ri=Ue(()=>kg.getAllFromStorage()),mt=Ue(()=>Ig.getAlldoctors()),Ai=Ue(()=>Lg.getAllFromDuration(y.value.duration.weeks)),rt=Ue(()=>ia.getAllFromStorage()),ge=Ue(()=>No.getLastStartEpisodeByIdentifier(S.identifier.id)),In=Ue(()=>No.getLastRefferalEpisodeByIdentifier(S.identifier.id)),it=Ue(()=>{const d=[];if(ge.value!==null&&ge.value!==void 0){const h=na.getAllPatientVisitDetailsFromEpisode(ge.value.id);return h!=null&&h.length!==0?h.forEach(p=>{d.push(p.patient_visit_id)}):Yo.getAllFromPatient(je.value.id).forEach(F=>{d.push(F.id)}),Yo.getLastFromPatientVisitList(d)}else return null}),_t=Ue(()=>{if(it.value!==null&&it.value!==void 0){const d=na.getLastPatientVisitDetailFromPatientVisitAndEpisode(it.value.id,ge.value.id);return d==null?na.getLastPatientVisitDetailFromPatientVisit(it.value.id):d}else return null}),Ee=Ue(()=>_t.value!==null&&_t.value!==void 0?Mg.getLastPrescriptionFromPatientVisitDetails(_t.value.prescription.id):null),Ke=Ue(()=>Ee.value!==null&&Ee.value!==void 0?Sr.getLastPackFromPatientVisitAndPrescription(Ee.value.id):null),rr=d=>d<=Ye().format("YYYY/MM/DD"),ir=()=>{Ee.value!==null&&Ee.value!==void 0&&(m.value.therapeuticRegimen=Ee.value.prescriptionDetails[0].therapeuticRegimen,m.value.therapeutic_regimen_id=Ee.value.prescriptionDetails[0].therapeuticRegimen.id,m.value.therapeuticLine=Ee.value.prescriptionDetails[0].therapeuticLine,m.value.therapeutic_line_id=Ee.value.prescriptionDetails[0].therapeuticLine.id,m.value.dispense_type_id=Ee.value.prescriptionDetails[0].dispenseType.id,m.value.dispenseType=Ee.value.prescriptionDetails[0].dispenseType,y.value.duration=Ee.value.duration,y.value.duration_id=Ee.value.duration.id,delete y.value.duration.prescriptions,y.value.doctor=Ee.value.doctor,y.value.doctor_id=Ee.value.doctor.id,y.value.patientStatus="Manuten\xE7\xE3o",y.value.patientType=Ee.value.patientType,y.value.prescribedDrugs=Ee.value.prescribedDrugs,y.value.prescribedDrugs.forEach(d=>{d.id=Wn(),d.prescription=null,d.prescription_id=null}))},Vt=d=>{if(ne(d)!==null&&ne(d)!==void 0){const F=ne(d).pack;if(F!=null){const R=Ye.utc(F.nextPickUpDate).local().format("DD-MM-YYYY"),Ze=Ye.utc(Tt.addToDate(U(ae.value,"YYYY-MM-DD"),{days:4})).local().format("DD-MM-YYYY");var h=Ye(R,"DD-MM-YYYY"),p=Ye(Ze,"DD-MM-YYYY");h.isAfter(p)&&N("O paciente ainda possui medicamentos "+d.service.code+" em casa  deseja  continuar com a cria\xE7\xE3o da nova prescri\xE7\xE3o?").then($e=>{$e||(ae.value="")})}}},ur=()=>{Te.value?(ae.value=Ye().format("DD-MM-YYYY"),m.value.prescription=y.value,m.value.prescription_id=y.value.id,y.value.leftDuration=j(y.value),ir()):(ae.value=$(Ee.value.prescriptionDate),y.value=Ee.value,y.value.syncStatus="N",y.value.prescriptionDetails.forEach(d=>{d.prescription=null,d.prescription_id=y.value.id,delete d.therapeuticRegimen.prescriptionDetails,delete d.therapeuticRegimen.drugs,delete d.therapeuticLine.prescriptionDetails}),m.value=y.value.prescriptionDetails[0],Ke.value.packagedDrugs.forEach(d=>{let h=new aa({id:Wn()});h.drug=d.drug,h.drug_id=d.drug.id,h.amtPerTime=d.amtPerTime!==0?d.amtPerTime:d.drug.defaultTimes,h.timesPerDay=d.timesPerDay!==0?d.amtPerTime:d.drug.defaultTimes,h.form=d.form!==null?d.form:d.drug.defaultPeriodTreatment,le.value.packagedDrugs.push(h)}),le.value.weeksSupply=Ke.value.weeksSupply,le.value.syncStatus="N",le.value.clinic=je.value.clinic,le.value.clinic_id=je.value.clinic_id,q.value.patient_visit_id=Ne.value.id,q.value.clinic_id=je.value.clinic_id,q.value.clinic=je.value.clinic,q.value.pack_id=le.value.id,q.value.pack=le.value,q.value.prescription=y.value,q.value.prescription_id=y.value.id,q.value.episode=ge.value,q.value.episode_id=ge.value.id,ce.value=!0)},Ti=()=>{let d="Os Seguintes Medicamentos Prescritos est\xE3o inactivos: ";Hn.value||(m.value.reasonForUpdateDesc="");let h=Tt.addToDate(U(ae.value,"YYYY-MM-DD"),{days:4});Ot.value&&Pe.value.validate(),Ar.value&&Be.value.validate(),m.value.spetialPrescription&&qe.value.validate(),Oe.value.validate(),rn.value.validate(),re.value.validate(),ke.value.validate(),!re.value.hasError&&!Oe.value.hasError&&!rn.value.hasError&&!ke.value.hasError&&(P(String(U(ae.value)))?(ge.value===null||ge.value===void 0)&&(In.value===null||In.value===void 0)?G("Nenhuma prescri\xE7\xE3o n\xE3o deve ser criada sem um Hist\xF3rico cl\xEDnico de In\xEDcio ou Refer\xEAncia."):x(U(ae.value))<x(ge.value!==null&&ge.value!==void 0?ge.value.episodeDate:In.value.episodeDate)?G("A data da prescri\xE7\xE3o n\xE3o deve ser anterior a data de inicio do tratamento no sector corrente"):m.value.spetialPrescription&&qe.value.hasError?G("Selecionou a Prescri\xE7\xE3o especial, neste caso deve indicar o motivo"):x(U(ae.value))>x(Ye())?G("A data da prescri\xE7\xE3o indicada \xE9 maior que a data da corrente"):y.value.prescribedDrugs.length===0?G("A Prescri\xE7\xE3o deve ter pelo menos um medicamento prescrito"):Cr()!==""?(d+=Cr(),G(d)):Ke.value!==null&&Ke.value!==void 0&&Ke.value.nextPickUpDate>h&&!m.value.spetialPrescription?G("Paciente tem medicamento em casa, Caso queira dispensar seleccione a prescri\xE7\xE3o como especial"):kr():G("A data da prescri\xE7\xE3o \xE9 inv\xE1lida."))},Ei=()=>Sr.checkIfExistsAnyQuanityRemainForDispense(q.value.pack.packagedDrugs),Ci=d=>{let h=0;const p=Sr.getLastPackFromPatientAndDrug(je,d);return p!=null&&(h=Number(p.quantityRemain)),h},Tr=d=>{const h=d.quantityRemain;return Math.floor(h/d.drug.packSize)},Er=d=>d.quantityRemain%d.drug.packSize,Cr=()=>{const d=y.value.prescribedDrugs;let h="";for(const p of d)p.drug.active===!1&&(h+=p.drug.name);return h},kr=()=>{y.value.leftDuration=j(y.value),y.value.prescriptionDetails=[],y.value.prescriptionDate=U(ae.value),y.value.doctor.clinic={},y.value.doctor.clinic.id=y.value.doctor.clinic_id,y.value.prescribedDrugs.forEach(d=>{d.prescription=null,d.prescription_id=null}),y.value.prescriptionDetails.push(m.value),y.value.prescriptionDetails.forEach(d=>{d.prescription=null,d.prescription_id=null,delete d.therapeuticRegimen.prescriptionDetails,delete d.therapeuticRegimen.drugs,delete d.therapeuticLine.prescriptionDetails}),y.value.clinic=je.value.clinic,y.value.clinic_id=je.value.clinic_id,le.value.clinic=je.value.clinic,le.value.clinic_id=je.value.clinic_id,le.value.providerUuid=sessionStorage.getItem("Btoa"),le.value.syncStatus="R",le.value.packagedDrugs=[],q.value.patient_visit_id=Ne.value.id,q.value.clinic=je.value.clinic,q.value.clinic_id=je.value.clinic_id,q.value.pack_id=le.value.id,q.value.pack=le.value,q.value.prescription=y.value,q.value.prescription_id=y.value.id,q.value.episode=ge.value!==null&&ge.value!==void 0?ge.value:In.value,q.value.episode_id=ge.value!==null&&ge.value!==void 0?ge.value.id:In.value.id,ki(),ce.value=!0,Cn!==void 0&&Cn.value!==null&&(q.value.prescription=y.value,Ne.value.patientVisitDetails.push(q.value))},ki=()=>{y.value.prescribedDrugs.forEach(d=>{let h=new aa({id:Wn()});if(h.drug=d.drug,h.drug_id=d.drug.id,h.amtPerTime=d.amtPerTime,h.timesPerDay=d.timesPerDay,h.form=d.form,Ke.value!==null)Ke.value.packagedDrugs.find(p=>{if(p.drug_id===h.drug_id){const F=fe(h,Ke.value.weeksSupply);Mt=Number(F)+Number(p.quantityRemain),h.quantityRemain=Mt}});else{const p=fe(h,le.value.weeksSupply);h.quantityRemain=p}d.quantityRemain=Mt,h.quantityRemain=Mt,le.value.packagedDrugs.push(h)})},Ii=async d=>{const h=[];let p=d.quantitySupplied;const F=le.value.pickupDate;Pi.getValidStockByDrugAndPickUpDateOnline(d.drug.id,F).then(R=>{let Ze=0;for(;p>0;){const $e=new Ug({id:Wn()});R[Ze].stockMoviment>=p?(p=0,$e.quantitySupplied=d.quantitySupplied):(p=Number(p-R[Ze].stockMoviment),$e.quantitySupplied=R[Ze].stockMoviment,Ze=Ze+1),$e.drug={},$e.drug.id=d.drug.id,$e.stock={},$e.stock.id=R[Ze].id,$e.creationDate=Ye().format("YYYY-MM-DD"),h.push($e)}d.packagedDrugStocks=h})},Ir=async()=>{let d=[];const h=q.value.pack.packagedDrugs;for(const p of h)if(await Lr(p,q.value.pack.weeksSupply))de.value&&!l.value&&Ii(p);else{const R=h.indexOf(p);d.push(R)}return d},Li=()=>{let d=[];const h=q.value.pack.packagedDrugs;for(const p of h)if(Number(p.quantitySupplied)<=0){const F=h.indexOf(p);d.push(F)}return d},Mi=async()=>{J.value=!0;let d=Tt.addToDate(q.value.pack.pickupDate,{days:4}),h=0;q.value.pack.packagedDrugs.forEach(R=>{const Ze=Sr.getLastPackFromPatientAndDrug(je,R.drug);if(Ze!=null){const $e=fe(R,q.value.pack.weeksSupply);h=Number($e)+Number(Ze.quantityRemain),R.quantityRemain=h}else{const $e=fe(R,q.value.pack.weeksSupply);R.quantityRemain=$e}});const p=Li(),F=await Ir();p.length>0?(J.value=!1,G(" Existem medicamentos sem quantidade por dispensar na lista. Por favor, remova")):F.length>0?(J.value=!1,G(" Existem medicamentos sem stock na lista. Por favor, remova")):Number(q.value.pack.weeksSupply/4)>j(q.value.prescription)?(J.value=!1,G("O Per\xEDodo para o qual pretende efectuar a dispensa \xE9 maior que o per\xEDodo remanescente nesta prescri\xE7\xE3o ["+j(q.value.prescription)+" mes(es)]")):q.value.pack.packagedDrugs.length===0?(J.value=!1,G("Deve ter pelo menos um medicamento para efectuar a dispensa")):Number(q.value.pack.weeksSupply)<=0?(J.value=!1,G("Por favor indicar o per\xEDodo para o qual pretende efectuar a dispensa de medicamento"+S.identifier.service.code)):x(q.value.pack.pickupDate)>x(Ye())?(J.value=!1,G("A data de levantamento indicada \xE9 maior que a data corrente")):Ke.value!==null&&Ke.value!==void 0&&x(Ke.value.nextPickUpDate)>x(d)?N("O paciente ainda possui medicamentos em casa provenientes da ultima dispensa, O sistema pode ajustar a data do proximo levantamento desta dispensa tendo em conta os medicamentos citados?").then(R=>{if(R){const Ze=Ye(Ke.value.nextPickUpDate).diff(Ye(q.value.pack.pickupDate),"days");Ze>0&&(q.value.pack.nextPickUpDate=Ye(q.value.pack.nextPickUpDate,"YYYY-MM-DD").add("d",Ze).toDate()),Ut(),J.value=!1}else Ut(),J.value=!1}):(Ut(),J.value=!1)},Ut=()=>{if(Ei()){let d=!1,h=`O paciente passar\xE1 a ter de Sobra os medicamentos: 

 `;const p=q.value.pack.packagedDrugs;for(const F of p)Ci(F.drug)>0&&(d=!0,h+="\0 "+Tr(F)+" frasco(s) e "+Er(F)+" unidade(s) de "+F.drug.name+`;

`);d&&D(h)}Q.value=!0,y.value.leftDuration=Number((Number(y.value.duration.weeks)-Number(le.value.weeksSupply))/4),Ne.value.visitDate=y.value.prescriptionDate,q.value.prescription=y.value,q.value.episode=ge.value!==null&&ge.value!==void 0?ge.value:In.value,q.value.episode_id=ge.value!==null&&ge.value!==void 0?ge.value.id:In.value.id,Ne.value.patientVisitDetails.push(q.value)},ar=()=>{Q.value=!1,J.value=!1;const d=Ne.value.patientVisitDetails.map(h=>h.id).indexOf(q.value.id);Ne.value.patientVisitDetails.splice(d,1)},Oi=async d=>{y.value.prescribedDrugs.some(p=>p.drug.id===d.drug.id)?(G("O medicamento seleccionado ja existe na lista dos medicamentos prescritos."),pe.value=!1):await Lr(d)?I(d,y.value.duration.weeks)<=0?(G(`Quantidade de Medicamento superior ao solicitado! 
 O frasco seleccionado possui quantidade de medicamento superior ao necess\xE1rio para cobrir o per\xEDodo de dispensa indicado.`),pe.value=!1):(d.prescribedQty=I(d,y.value.duration.weeks),qt(d),pe.value=!1):(ve("O medicamento seleccionado n\xE3o possui stock suficiente para dispensar at\xE9 a data da prescri\xE7\xE3o."),d.prescribedQty=I(d,y.value.duration.weeks),qt(d),pe.value=!1)},qt=d=>{ht.value=!1,y.value.prescribedDrugs.push(new Go(d))},qn=d=>bi.getCleanDrugById(d),Lr=async(d,h)=>{const p=I(d,h),F=x(U(ae.value));return await Pi.checkStockStatus(d.drug.id,F,p,la.currClinic().id,h)},Fi=d=>{const h=y.value.prescribedDrugs.map(p=>p.id).indexOf(d.id);y.value.prescribedDrugs.splice(h,1)},Vi=(d,h,p)=>{const F=kn;d===""?h(()=>{Et.value=F.value.map(R=>R)}):F.value.length===0?h(()=>{Et.value=[]}):h(()=>{Et.value=F.value.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Ui=(d,h,p)=>{const F=Ft.value;d===""?h(()=>{Ct.value=F.map(R=>R)}):F.length===0?h(()=>{Ct.value=[]}):h(()=>{Ct.value=F.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},qi=(d,h,p)=>{const F=Ri;d===""?h(()=>{En.value=F.value.map(R=>R)}):F.value.length===0?h(()=>{En.value=[]}):h(()=>{En.value=F.value.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Ni=(d,h,p)=>{const F=rt;d===""?h(()=>{$n.value=F.value.map(R=>R)}):F.value.length===0?h(()=>{$n.value=[]}):h(()=>{$n.value=F.value.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Yi=(d,h,p)=>{const F=mt;d===""?h(()=>{kt.value=F.value.map(R=>R)}):F.value.length===0?h(()=>{kt.value=[]}):h(()=>{kt.value=F.value.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Mr=(d,h,p)=>{const F=vt.value;d===""?h(()=>{zn.value=F.map(R=>R)}):F.length===0?h(()=>{zn.value=[]}):h(()=>{zn.value=F.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Bi=(d,h,p)=>{const F=Ai.value;d===""?h(()=>{Un.value=F.map(R=>R)}):F.length===0?h(()=>{Un.value=[]}):h(()=>{Un.value=F.map(R=>R).filter(R=>R&&R.description.toLowerCase().indexOf(d.toLowerCase())!==-1)})},Wi=(d,h,p)=>{const F=tt.value;d===""?h(()=>{It.value=F.map(R=>R)}):F.value.length===0?h(()=>{It.value=[]}):h(()=>{It.value=F.value.map(R=>R).filter(R=>R&&R.toLowerCase().indexOf(d.toLowerCase())!==-1)})};return Si(()=>{ur()}),Le("curPatientVisit",Ne),Le("curPrescription",y),Le("curPrescriptionDetail",m),Le("curPatientVisitDetail",q),Le("curPack",le),Le("lastPack",Ke),Le("durations",rt),Le("hasTherapeuticalRegimen",Ot),Le("curIdentifier",S.identifier),Le("showAddEditDrug",ht),Le("addPrescribedDrug",Oi),Le("validateDispense",Q),Le("addPatientVisitDetail",Mi),Le("removePatientVisitDetail",ar),Le("submittingPrescribedDrug",pe),Le("submittingValidateDispense",J),(d,h)=>(ue(),Tn(Vg,null,[se("div",dm,[se("div",pm,[se("div",vm,[E(tr,{dense:"",outlined:"",disable:ce.value||!A(Te),class:"col q-mb-md",modelValue:ae.value,"onUpdate:modelValue":[h[2]||(h[2]=p=>ae.value=p),h[3]||(h[3]=p=>Vt(S.identifier))],ref_key:"prescriptionDateRef",ref:M,label:"Data da Prescri\xE7\xE3o"},{append:O(()=>[E(nr,{name:"event",class:"cursor-pointer"},{default:O(()=>[E(oa,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:O(()=>[E(sa,{modelValue:ae.value,"onUpdate:modelValue":[h[0]||(h[0]=p=>ae.value=p),h[1]||(h[1]=p=>Vt(S.identifier))],disable:ce.value||!A(Te),options:rr,mask:"DD-MM-YYYY"},{default:O(()=>[se("div",hm,[ua(E(Qe,{label:"Close",color:"primary",flat:""},null,512),[[ca]])])]),_:1},8,["modelValue","disable"])]),_:1},512)]),_:1})]),_:1},8,["disable","modelValue"]),se("div",gm,[se("div",mm,[E(Og,{modelValue:m.value.spetialPrescription,"onUpdate:modelValue":h[4]||(h[4]=p=>m.value.spetialPrescription=p),disable:ce.value||!A(Te),label:"Prescri\xE7\xE3o especial",class:"col-4 q-mb-sm"},null,8,["modelValue","disable"]),m.value.spetialPrescription?(ue(),Ae(An,{key:0,class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te),modelValue:m.value.spetialPrescriptionMotive,"onUpdate:modelValue":h[5]||(h[5]=p=>m.value.spetialPrescriptionMotive=p),options:Et.value,ref_key:"spetialMotiveRef",ref:qe,rules:[p=>!!p||"Por favor indicar o motivo da prescri\xE7\xE3o especial"],"option-value":"id","option-label":"description",onFilter:Vi,label:"Motivo da prescri\xE7\xE3o especial"},null,8,["disable","modelValue","options","rules"])):Me("",!0)])])]),se("div",_m,[Ot.value?(ue(),Ae(An,{key:0,class:"col q-mr-sm","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te),ref_key:"therapeuticRegimenRef",ref:Pe,rules:[p=>!!p||"Por favor indicar o regime terap\xEAutico"],modelValue:m.value.therapeuticRegimen,"onUpdate:modelValue":[h[6]||(h[6]=p=>m.value.therapeuticRegimen=p),h[7]||(h[7]=p=>y.value.prescribedDrugs=[])],options:Ct.value,"option-value":"id","option-label":"description",onFilter:Ui,label:"Regime Terap\xEAutico"},null,8,["disable","rules","modelValue","options"])):Me("",!0),Ar.value?(ue(),Ae(An,{key:1,class:"col q-mr-sm","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te),ref_key:"therapeuticLineRef",ref:Be,rules:[p=>!!p||"Por favor indicar a linha terap\xEAutica"],modelValue:m.value.therapeuticLine,"onUpdate:modelValue":h[8]||(h[8]=p=>m.value.therapeuticLine=p),options:En.value,"option-value":"id","option-label":"description",onFilter:qi,label:"Linha Terap\xEAutica"},null,8,["disable","rules","modelValue","options"])):Me("",!0),E(An,{class:"col q-mr-sm","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te),modelValue:y.value.duration,"onUpdate:modelValue":[h[9]||(h[9]=p=>y.value.duration=p),h[10]||(h[10]=p=>m.value.dispenseType="")],options:$n.value,ref_key:"durationRef",ref:Oe,rules:[p=>!!p||"Por favor indicar a dura\xE7\xE3o"],"option-value":"id","option-label":"description",onFilter:Ni,label:"Dura\xE7\xE3o"},null,8,["disable","modelValue","options","rules"]),E(An,{class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te),ref_key:"doctorRef",ref:rn,rules:[p=>!!p||"Por favor indicar o cl\xEDnico"],modelValue:y.value.doctor,"onUpdate:modelValue":h[11]||(h[11]=p=>y.value.doctor=p),options:kt.value,"option-value":"id","option-label":"fullName",onFilter:Yi,label:"Cl\xEDnico"},null,8,["disable","rules","modelValue","options"])]),se("div",null,[wm,E(Di,{color:"grey-13",size:"1px",class:"q-mb-sm"})]),se("div",null,[E(Xo,{dense:"","inline-actions":"",class:"bg-grey-6 text-white q-pa-none"},{action:O(()=>[ce.value?Me("",!0):(ue(),Ae(Qe,{key:0,round:"",icon:"add",onClick:h[12]||(h[12]=p=>ht.value=!0),flat:""}))]),default:O(()=>[ym]),_:1}),E(jo,{flat:"",bordered:"",dense:"","hide-bottom":"",rows:y.value.prescribedDrugs,columns:Lt,"row-key":"id"},{body:O(p=>[E(fa,{"no-hover":"",props:p},{default:O(()=>[E(Vn,{key:"drug",props:p},{default:O(()=>[tn(be(qn(p.row.drug.id)!==null&&qn(p.row.drug.id)!==void 0?qn(p.row.drug.id).name.includes(String(A(K)(p.row.drug.id).form.description).substring(0,4))?qn(p.row.drug.id).name:qn(p.row.drug.id).name+" - ("+qn(p.row.drug.id).packSize+" "+String(A(K)(p.row.drug.id).form.description).substring(0,4)+")":""),1)]),_:2},1032,["props"]),E(Vn,{key:"dosage",props:p},{default:O(()=>[tn(be(qn(p.row.drug.id)!==null&&qn(p.row.drug.id)!==void 0?A(K)(p.row.drug.id).form.howToUse+" "+p.row.amtPerTime+"   "+A(K)(p.row.drug.id).form.unit+" - "+p.row.timesPerDay+" vez(es) por "+p.row.form:""),1)]),_:2},1032,["props"]),E(Vn,{"auto-width":"",key:"packs",props:p},{default:O(()=>[tn(be(A(I)(p.row,y.value.duration.weeks)>0?A(I)(p.row,y.value.duration.weeks):1)+" ",1),A(K)(p.row.drug.id).clinicalService.code==="TARV"?(ue(),Tn("em",Dm," Frasco(s) ")):(ue(),Tn("em",bm,be(A(K)(p.row.drug.id).form.description)+"(s)",1))]),_:2},1032,["props"]),E(Vn,{"auto-width":"",key:"packs",props:p},{default:O(()=>[A(K)(p.row.drug.id).clinicalService.code==="TARV"?(ue(),Tn("em",Pm,be(Math.floor(A(fe)(p.row,y.value.duration.weeks)/p.row.drug.packSize))+" Frasco(s) e "+be(A(fe)(p.row,y.value.duration.weeks)+" "+A(K)(p.row.drug.id).form.unit),1)):(ue(),Tn("em",xm,be(Math.floor(A(fe)(p.row,y.value.duration.weeks)/p.row.drug.packSize))+" "+be(A(K)(p.row.drug.id).form.description)+"(s) ",1))]),_:2},1032,["props"]),E(Vn,{key:"options",props:p},{default:O(()=>[E(Qe,{flat:"",round:"",color:"red",icon:"delete",disable:ce.value||!A(Te),onClick:F=>Fi(p.row)},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"]),E(Di,{color:"grey-13",size:"1px",class:"q-mb-sm"})]),se("div",null,[Sm,E(Di,{color:"grey-13",size:"1px",class:"q-mb-sm"})]),se("div",Rm,[se("div",Am,[se("div",Tm,[E(ta,{dense:"",caption:""},{default:O(()=>[tn("Altera Linha Terap\xEAutica?")]),_:1}),E(Bo,{modelValue:y.value.patientType,"onUpdate:modelValue":h[13]||(h[13]=p=>y.value.patientType=p),disable:ce.value||!A(Te),"checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"N/A",label:"N\xE3o"},null,8,["modelValue","disable"]),E(Bo,{modelValue:y.value.patientType,"onUpdate:modelValue":h[14]||(h[14]=p=>y.value.patientType=p),disable:ce.value||!A(Te),"checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"Alterar",label:"Sim"},null,8,["modelValue","disable"])])]),se("div",null,[gt.value&&String(y.value.patientType).includes("Alterar")?(ue(),Ae(An,{key:0,hint:Hn.value?dn.value:"",class:"col q-mr-sm","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",ref_key:"reasonForUpdateRef",ref:We,dense:"",outlined:"","option-value":"code",disable:ce.value||!A(Te),options:vt.value,modelValue:m.value.reasonForUpdate,"onUpdate:modelValue":h[15]||(h[15]=p=>m.value.reasonForUpdate=p),"option-label":"description",onFilter:Mr,label:"Motivo Altera\xE7\xE3o"},{option:O(p=>[p.opt==="Outro"?(ue(),Ae(zo,Wo($o({key:0},p.itemProps)),{default:O(()=>[E(ra,null,{default:O(()=>[E(ta,null,{default:O(()=>[tn(be(p.opt),1)]),_:2},1024)]),_:2},1024),E(ra,{avatar:""},{default:O(()=>[E(nr,{name:"edit"})]),_:1})]),_:2},1040)):(ue(),Ae(zo,Wo($o({key:1},p.itemProps)),{default:O(()=>[E(ra,null,{default:O(()=>[E(ta,null,{default:O(()=>[tn(be(p.opt),1)]),_:2},1024)]),_:2},1024)]),_:2},1040))]),_:1},8,["hint","disable","options","modelValue"])):Me("",!0),Hn.value&&String(y.value.patientType).includes("Alterar")?(ue(),Tn("div",Em,[E(Qe,{class:"glossy",size:"sm",color:"primary",label:"Indicar Motivo"},{default:O(()=>[E(zg,{"transition-show":"flip-up","transition-hide":"flip-down",class:"shadow-up-21 shadow-24",modelValue:m.value.reasonForUpdateDesc,"onUpdate:modelValue":h[16]||(h[16]=p=>m.value.reasonForUpdateDesc=p),cover:!1,fit:"",buttons:"","label-set":"OK","label-cancel":"Cancelar",offset:[0,-130]},{default:O(p=>[E(tr,{color:"primary",modelValue:p.value,"onUpdate:modelValue":F=>p.value=F,label:"Descric\xE3o Outro Motivo",dense:"",autofocus:"",onKeyup:Fg(p.set,["enter"])},{prepend:O(()=>[E(nr,{name:"edit",color:"primary"})]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])]),_:1})])):Me("",!0)]),E(An,{class:"col q-mr-sm","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:ce.value||!A(Te)||A(Cn)!=null,ref_key:"dispenseTypeRef",ref:ke,rules:[p=>!!p||"Por favor indicar o tipo de dispensa"],modelValue:m.value.dispenseType,"onUpdate:modelValue":h[17]||(h[17]=p=>m.value.dispenseType=p),options:Un.value,"option-value":"id","option-label":"description",onFilter:Bi,label:"Paciente em "},null,8,["disable","rules","modelValue","options"]),E(An,{class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",ref_key:"patientStatusRef",ref:re,rules:[p=>!!p||"Por favor indicar a situa\xE7\xE3o do paciente (em rela\xE7\xE3o aos modelos)"],disable:ce.value||!A(Te),modelValue:y.value.patientStatus,"onUpdate:modelValue":h[18]||(h[18]=p=>y.value.patientStatus=p),options:It.value,onFilter:Wi,dense:"",outlined:"",label:"Situacao do paciente (em rela\xE7\xE3o aos modelos)"},null,8,["rules","disable","modelValue","options"])]),se("div",Cm,[ce.value?Me("",!0):(ue(),Ae(Qe,{key:0,unelevated:"",color:"primary",disable:ce.value||!A(Te),label:"Validar Prescric\xE3o",class:"all-pointer-events",onClick:h[19]||(h[19]=p=>Ti())},null,8,["disable"])),ce.value?(ue(),Ae(Qe,{key:1,unelevated:"",color:"red",disable:!ce.value||Q.value||!A(Te),label:"Invalidar Prescric\xE3o",class:"all-pointer-events",onClick:h[20]||(h[20]=p=>ce.value=!1)},null,8,["disable"])):Me("",!0)])])]),ce.value&&A(Cn)==null||!A(Te)&&A(Cn)==null?(ue(),Tn("div",km,[se("div",null,[E(cm)])])):Me("",!0),E(Jo,{persistent:"",modelValue:ht.value,"onUpdate:modelValue":h[21]||(h[21]=p=>ht.value=p)},{default:O(()=>[E(ts)]),_:1},8,["modelValue"])],64))}};export{Bm as _,$g as a,ns as b,xi as c,ts as d,Bg as u};
