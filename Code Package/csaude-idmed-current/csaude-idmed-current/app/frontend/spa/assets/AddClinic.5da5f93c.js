import{K as q,L as R,M as u,f as o,P as T,U as _,Z as O,r as d,i as v,o as K,c as p,$ as S,a0 as L,c7 as z,bf as W,O as t,R as Z,N as A,a7 as i,cn as G,V as F,a6 as H,bP as J,S as X,W as Y,b8 as ee,b4 as le}from"./index.28c7e456.js";import{Q as x}from"./QSelect.caa108f8.js";import{Q as ae}from"./QScrollArea.288f8a37.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";import"./QMenu.9a83401e.js";import"./position-engine.b3fa6cbd.js";import"./TouchPan.90ce57a2.js";const ie={props:["phone"]};function se(P,c,m,Q,f,n){return q(),R(_,{outlined:"",class:"col",ref:"ref",dense:"",value:m.phone,maxlength:"12",type:"tel",onInput:c[0]||(c[0]=b=>P.$emit("update:phone",b.target.value)),"lazy-rules":""},{prepend:u(()=>[o(T,{name:"phone_android"})]),_:1},8,["value"])}var te=oe(ie,[["render",se]]);const ne={class:"q-pa-md"},re={class:"row items-center"},de=t("span",{class:"q-pl-sm text-subtitle2"},"Farm\xE1cia",-1),ue={class:"row q-mt-md"},ce={class:"row q-mt-md"},ve={class:"row q-mt-md"},pe={class:"row"},me={class:"row q-mt-md"},we={__name:"AddClinic",setup(P){const{alertSucess:c,alertError:m}=le(),{isProvincialInstalation:Q}=O(),f=d([]),n=d(!1),b=v("createMode"),e=v("clinic"),k=v("clinic"),y=v("showClinicRegistrationScreen"),g=d(null),h=d(null),V=d(null),w=d(null),C=d(null),N=v("viewMode");K(()=>{B()});const r=p(()=>N.value),U=p(()=>S.getAllClinics()),$=p(()=>L.getAllProvinces()),E=p(()=>Q()?z.getFacilityTypeClinics():z.getAllFacilityTypes()),M=p(()=>e.value.province!==null?W.getAllDistrictByProvinceId(e.value.province.id):null),B=()=>{U.value.forEach(s=>{f.value.push(s.code)})},I=s=>{if(e.value.code==="")return"o C\xF3digo e obrigatorio";if(b.value)return!f.value.includes(s)||"o C\xF3digo indicado ja existe";if(k.value.code!==e.value.code)return f.value.includes(s)||"o C\xF3digo indicado ja existe"},D=()=>{n.value=!0,g.value.validate(),h.value.validate(),V.value.validate(),w.value.validate(),C.value.validate(),!g.value.hasError&&!h.value.hasError&&!V.value.hasError&&!w.value.hasError&&!C.value.hasError?j():n.value=!1},j=()=>{b.value?(e.value.active=!0,e.value.uuid=ee(),e.value.syncStatus="P",S.post(e.value).then(()=>{c("Farm\xE1cia registada com sucesso."),n.value=!1,y.value=!1}).catch(s=>{console.log(s),m("Aconteceu um erro inesperado ao registar a Farm\xE1cia."),n.value=!1,y.value=!1})):S.patch(e.value.id,e.value).then(()=>{c("Farm\xE1cia actualizada com sucesso."),n.value=!1,y.value=!1}).catch(s=>{console.log(s),m("Aconteceu um erro inesperado ao actualizar a Farm\xE1cia."),n.value=!1,y.value=!1})};return(s,a)=>(q(),R(Y,{style:{width:"900px","max-width":"90vw"}},{default:u(()=>[o(A,{class:"q-pa-none bg-green-2"},{default:u(()=>[t("div",ne,[t("div",re,[o(T,{name:"local_hospital",size:"sm"}),de])]),o(Z,{color:"grey-13",size:"1px"})]),_:1}),t("form",{onSubmit:X(D,["prevent"])},[o(ae,{style:{height:"600px"}},{default:u(()=>[o(A,{class:"q-px-md"},{default:u(()=>[t("div",ue,[o(_,{outlined:"",dense:"",class:"col",modelValue:i(e).clinicName,"onUpdate:modelValue":a[0]||(a[0]=l=>i(e).clinicName=l),label:"Nome da Farm\xE1cia *",disable:r.value,ref_key:"nomeRef",ref:g,rules:[l=>!!l||"Por favor indicar o nome"],"lazy-rules":""},null,8,["modelValue","disable","rules"])]),t("div",ce,[o(_,{outlined:"",dense:"",ref_key:"codeRef",ref:h,class:"col",modelValue:i(e).code,"onUpdate:modelValue":a[1]||(a[1]=l=>i(e).code=l),rules:[l=>I(l)],disable:r.value,"lazy-rules":"",label:"C\xF3digo *"},null,8,["modelValue","rules","disable"]),o(x,{dense:"",outlined:"",class:"q-ml-md col",modelValue:i(e).facilityType,"onUpdate:modelValue":a[2]||(a[2]=l=>i(e).facilityType=l),disable:r.value,options:E.value,"transition-show":"flip-up","transition-hide":"flip-down",ref_key:"facilityTypeRef",ref:V,"option-value":"id","option-label":"description",rules:[l=>l!=null||" Por favor indique o tipo de farmacia"],"lazy-rules":"",label:"Tipo de Farm\xE1cia *"},null,8,["modelValue","disable","options","rules"])]),t("div",ve,[o(x,{dense:"",outlined:"",class:"col",modelValue:i(e).province,"onUpdate:modelValue":a[3]||(a[3]=l=>i(e).province=l),disable:r.value,options:$.value,"transition-show":"flip-up","transition-hide":"flip-down",ref_key:"provinceRef",ref:w,"option-value":"id","option-label":"description",rules:[l=>l!=null||" Por favor indique a prov\xEDncia"],"lazy-rules":"",label:"Prov\xEDncia *"},null,8,["modelValue","disable","options","rules"]),o(x,{class:"q-ml-md col",dense:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",disable:r.value,modelValue:i(e).district,"onUpdate:modelValue":a[4]||(a[4]=l=>i(e).district=l),options:M.value,ref_key:"districtRef",ref:C,"option-value":"id","option-label":"description",rules:[l=>l!=null||" Por favor indique o Distrito"],"lazy-rules":"",label:"Distrito"},null,8,["disable","modelValue","options","rules"])]),t("div",pe,[o(te,{modelValue:i(e).telephone,"onUpdate:modelValue":a[5]||(a[5]=l=>i(e).telephone=l),dense:"",label:"N\xFAmero de Telefone",disable:r.value},null,8,["modelValue","disable"])]),t("div",me,[o(_,{outlined:"",class:"col",modelValue:i(e).notes,"onUpdate:modelValue":a[6]||(a[6]=l=>i(e).notes=l),type:"textarea",label:"Notas",dense:"",disable:r.value},null,8,["modelValue","disable"])])]),_:1}),o(G)]),_:1}),o(J,{align:"right",class:"q-mb-md"},{default:u(()=>[o(F,{label:"Cancelar",color:"red",onClick:a[7]||(a[7]=l=>s.$emit("close"))}),r.value?H("",!0):(q(),R(F,{key:0,type:"submit",loading:n.value,label:"Submeter",color:"primary"},null,8,["loading"]))]),_:1})],32)]),_:1}))}};export{we as default};
